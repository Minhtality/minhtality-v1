"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./manifest.json"),t=require("./routes-manifest.json"),r=require("stream"),n=require("zlib"),o=require("http");function a(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function i(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(r){if("default"!==r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})}})),t.default=e,Object.freeze(t)}var s=a(e),u=a(t),c=a(r),f=a(n),l=a(o),p=i(o);const d={"accept-encoding":!0,"content-length":!0,"if-modified-since":!0,"if-none-match":!0,"if-range":!0,"if-unmodified-since":!0,"transfer-encoding":!0,via:!0},y={202:"Accepted",502:"Bad Gateway",400:"Bad Request",409:"Conflict",100:"Continue",201:"Created",417:"Expectation Failed",424:"Failed Dependency",403:"Forbidden",504:"Gateway Timeout",410:"Gone",505:"HTTP Version Not Supported",418:"I'm a teapot",419:"Insufficient Space on Resource",507:"Insufficient Storage",500:"Server Error",411:"Length Required",423:"Locked",420:"Method Failure",405:"Method Not Allowed",301:"Moved Permanently",302:"Moved Temporarily",207:"Multi-Status",300:"Multiple Choices",511:"Network Authentication Required",204:"No Content",203:"Non Authoritative Information",406:"Not Acceptable",404:"Not Found",501:"Not Implemented",304:"Not Modified",200:"OK",206:"Partial Content",402:"Payment Required",308:"Permanent Redirect",412:"Precondition Failed",428:"Precondition Required",102:"Processing",407:"Proxy Authentication Required",431:"Request Header Fields Too Large",408:"Request Timeout",413:"Request Entity Too Large",414:"Request-URI Too Long",416:"Requested Range Not Satisfiable",205:"Reset Content",303:"See Other",503:"Service Unavailable",101:"Switching Protocols",307:"Temporary Redirect",429:"Too Many Requests",401:"Unauthorized",422:"Unprocessable Entity",415:"Unsupported Media Type",305:"Use Proxy"},h={enableHTTPCompression:!1},m=(e,{enableHTTPCompression:t,rewrittenUri:r}=h)=>{const{request:n,response:o={headers:{}}}=e,a={headers:{}},i=new c.default.Readable,s=Object.assign(i,l.default.IncomingMessage.prototype);s.url=r||n.uri,s.method=n.method,s.rawHeaders=[],s.headers={},s.connection={},n.querystring&&(s.url=s.url+"?"+n.querystring);const u=n.headers||{};for(const e of Object.keys(u)){const t=u[e];t.forEach((e=>{s.rawHeaders.push(e.key),s.rawHeaders.push(e.value)})),s.headers[e]=t[0].value}s.getHeader=e=>s.headers[e.toLowerCase()],s.getHeaders=()=>s.headers,n.body&&n.body.data&&s.push(n.body.data,n.body.encoding?"base64":void 0),s.push(null);const p=new c.default;p.finished=!1,Object.defineProperty(p,"statusCode",{get:()=>a.status,set(e){a.status=e,a.statusDescription=y[e]}}),p.headers={},p.writeHead=(e,t)=>(a.status=e,t&&(p.headers=Object.assign(p.headers,t)),p),p.write=e=>{a.body||(a.body=Buffer.from("")),a.body=Buffer.concat([a.body,Buffer.isBuffer(e)?e:Buffer.from(e)])};let m=t&&(e=>{let t=!1;const r=e["accept-encoding"];if(r)for(let e=0;e<r.length;e++){const{value:n}=r[e];-1!==n.split(",").map((e=>e.split(";")[0].trim())).indexOf("gzip")&&(t=!0)}return t})(u);const g=new Promise((e=>{p.end=t=>{!0!==p.finished&&(p.finished=!0,t&&p.write(t),p.statusCode||(p.statusCode=200),a.body&&(a.bodyEncoding="base64",a.body=m?f.default.gzipSync(a.body).toString("base64"):Buffer.from(a.body).toString("base64")),a.headers=((e,t)=>{const r={},n={};return Object.entries(t).forEach((([e,t])=>{n[e.toLowerCase()]=t})),Object.keys(e).forEach((t=>{const o=t.toLowerCase(),a=e[t];d[o]?n[o]&&(r[o]=n[o]):(r[o]=[],a instanceof Array?a.forEach((e=>{r[o].push({key:t,value:e.toString()})})):r[o].push({key:t,value:a.toString()}))})),r})(p.headers,o.headers),m&&(a.headers["content-encoding"]=[{key:"Content-Encoding",value:"gzip"}]),e(a))}}));return p.setHeader=(e,t)=>{p.headers[e.toLowerCase()]=t},p.removeHeader=e=>{delete p.headers[e.toLowerCase()]},p.getHeader=e=>p.headers[e.toLowerCase()],p.getHeaders=()=>p.headers,p.hasHeader=e=>!!p.getHeader(e),{req:s,res:p,responsePromise:g}};m.SPECIAL_NODE_HEADERS=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];var g=m;function b(e,t){void 0===t&&(t={});for(var r=function(e){for(var t=[],r=0;r<e.length;){var n=e[r];if("*"!==n&&"+"!==n&&"?"!==n)if("\\"!==n)if("{"!==n)if("}"!==n)if(":"!==n)if("("!==n)t.push({type:"CHAR",index:r,value:e[r++]});else{var o=1,a="";if("?"===e[s=r+1])throw new TypeError('Pattern cannot start with "?" at '+s);for(;s<e.length;)if("\\"!==e[s]){if(")"===e[s]){if(0==--o){s++;break}}else if("("===e[s]&&(o++,"?"!==e[s+1]))throw new TypeError("Capturing groups are not allowed at "+s);a+=e[s++]}else a+=e[s++]+e[s++];if(o)throw new TypeError("Unbalanced pattern at "+r);if(!a)throw new TypeError("Missing pattern at "+r);t.push({type:"PATTERN",index:r,value:a}),r=s}else{for(var i="",s=r+1;s<e.length;){var u=e.charCodeAt(s);if(!(u>=48&&u<=57||u>=65&&u<=90||u>=97&&u<=122||95===u))break;i+=e[s++]}if(!i)throw new TypeError("Missing parameter name at "+r);t.push({type:"NAME",index:r,value:i}),r=s}else t.push({type:"CLOSE",index:r,value:e[r++]});else t.push({type:"OPEN",index:r,value:e[r++]});else t.push({type:"ESCAPED_CHAR",index:r++,value:e[r++]});else t.push({type:"MODIFIER",index:r,value:e[r++]})}return t.push({type:"END",index:r,value:""}),t}(e),n=t.prefixes,o=void 0===n?"./":n,a="[^"+C(t.delimiter||"/#?")+"]+?",i=[],s=0,u=0,c="",f=function(e){if(u<r.length&&r[u].type===e)return r[u++].value},l=function(e){var t=f(e);if(void 0!==t)return t;var n=r[u],o=n.type,a=n.index;throw new TypeError("Unexpected "+o+" at "+a+", expected "+e)},p=function(){for(var e,t="";e=f("CHAR")||f("ESCAPED_CHAR");)t+=e;return t};u<r.length;){var d=f("CHAR"),y=f("NAME"),h=f("PATTERN");if(y||h){var m=d||"";-1===o.indexOf(m)&&(c+=m,m=""),c&&(i.push(c),c=""),i.push({name:y||s++,prefix:m,suffix:"",pattern:h||a,modifier:f("MODIFIER")||""})}else{var g=d||f("ESCAPED_CHAR");if(g)c+=g;else if(c&&(i.push(c),c=""),f("OPEN")){m=p();var b=f("NAME")||"",w=f("PATTERN")||"",v=p();l("CLOSE"),i.push({name:b||(w?s++:""),pattern:b&&!w?a:w,prefix:m,suffix:v,modifier:f("MODIFIER")||""})}else l("END")}}return i}function w(e,t){return function(e,t){void 0===t&&(t={});var r=E(t),n=t.encode,o=void 0===n?function(e){return e}:n,a=t.validate,i=void 0===a||a,s=e.map((function(e){if("object"==typeof e)return new RegExp("^(?:"+e.pattern+")$",r)}));return function(t){for(var r="",n=0;n<e.length;n++){var a=e[n];if("string"!=typeof a){var u=t?t[a.name]:void 0,c="?"===a.modifier||"*"===a.modifier,f="*"===a.modifier||"+"===a.modifier;if(Array.isArray(u)){if(!f)throw new TypeError('Expected "'+a.name+'" to not repeat, but got an array');if(0===u.length){if(c)continue;throw new TypeError('Expected "'+a.name+'" to not be empty')}for(var l=0;l<u.length;l++){var p=o(u[l],a);if(i&&!s[n].test(p))throw new TypeError('Expected all "'+a.name+'" to match "'+a.pattern+'", but got "'+p+'"');r+=a.prefix+p+a.suffix}}else if("string"!=typeof u&&"number"!=typeof u){if(!c){var d=f?"an array":"a string";throw new TypeError('Expected "'+a.name+'" to be '+d)}}else{p=o(String(u),a);if(i&&!s[n].test(p))throw new TypeError('Expected "'+a.name+'" to match "'+a.pattern+'", but got "'+p+'"');r+=a.prefix+p+a.suffix}}else r+=a}return r}}(b(e,t),t)}function v(e,t){var r=[];return function(e,t,r){void 0===r&&(r={});var n=r.decode,o=void 0===n?function(e){return e}:n;return function(r){var n=e.exec(r);if(!n)return!1;for(var a=n[0],i=n.index,s=Object.create(null),u=function(e){if(void 0===n[e])return"continue";var r=t[e-1];"*"===r.modifier||"+"===r.modifier?s[r.name]=n[e].split(r.prefix+r.suffix).map((function(e){return o(e,r)})):s[r.name]=o(n[e],r)},c=1;c<n.length;c++)u(c);return{path:a,index:i,params:s}}}(j(e,r,t),r,t)}function C(e){return e.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function E(e){return e&&e.sensitive?"":"i"}function x(e,t,r){return function(e,t,r){void 0===r&&(r={});for(var n=r.strict,o=void 0!==n&&n,a=r.start,i=void 0===a||a,s=r.end,u=void 0===s||s,c=r.encode,f=void 0===c?function(e){return e}:c,l="["+C(r.endsWith||"")+"]|$",p="["+C(r.delimiter||"/#?")+"]",d=i?"^":"",y=0,h=e;y<h.length;y++){var m=h[y];if("string"==typeof m)d+=C(f(m));else{var g=C(f(m.prefix)),b=C(f(m.suffix));if(m.pattern)if(t&&t.push(m),g||b)if("+"===m.modifier||"*"===m.modifier){var w="*"===m.modifier?"?":"";d+="(?:"+g+"((?:"+m.pattern+")(?:"+b+g+"(?:"+m.pattern+"))*)"+b+")"+w}else d+="(?:"+g+"("+m.pattern+")"+b+")"+m.modifier;else d+="("+m.pattern+")"+m.modifier;else d+="(?:"+g+b+")"+m.modifier}}if(u)o||(d+=p+"?"),d+=r.endsWith?"(?="+l+")":"$";else{var v=e[e.length-1],x="string"==typeof v?p.indexOf(v[v.length-1])>-1:void 0===v;o||(d+="(?:"+p+"(?="+l+"))?"),x||(d+="(?="+p+"|"+l+")")}return new RegExp(d,E(r))}(b(e,r),t,r)}function j(e,t,r){return e instanceof RegExp?function(e,t){if(!t)return e;var r=e.source.match(/\((?!\?)/g);if(r)for(var n=0;n<r.length;n++)t.push({name:n,prefix:"",suffix:"",modifier:"",pattern:""});return e}(e,t):Array.isArray(e)?function(e,t,r){var n=e.map((function(e){return j(e,t,r).source}));return new RegExp("(?:"+n.join("|")+")",E(r))}(e,t,r):x(e,t,r)}function q(e,t){return v(t,{decode:decodeURIComponent})(e)}function O(e,t){try{const r=e.toLowerCase();if(r.startsWith("https://")||r.startsWith("http://")){const{origin:r,pathname:n}=new URL(e),o=`${r}${w(n,{encode:encodeURIComponent})(t)}`;return!e.endsWith("/")&&o.endsWith("/")?o.slice(0,-1):o}{const r=e.replace(/\?/g,"\\?");return w(r,{encode:encodeURIComponent})(t)}}catch(t){return console.error(`Could not compile destination ${e}, returning null instead. Error: ${t}`),null}}function A(e,t){if(t.i18n){const r=t.i18n.defaultLocale,n=t.i18n.locales,o=t.basePath;for(const r of n)if(e===`${t.basePath}/${r}`||e.startsWith(`${t.basePath}/${r}/`))return e;return"/"===e||e===""+o?`${o}/${r}`:e.replace(o+"/",`${o}/${r}/`)}return e}function S(e,t){if(t.i18n)for(const r of t.i18n.locales)if(e==="/"+r||e.startsWith(`/${r}/`))return!0;return!1}function R(e,t){if(t.i18n)for(const r of t.i18n.locales){if(e==="/"+r)return"/";if(e.startsWith(`/${r}/`))return e.replace("/"+r,"")}return e}function P(e,t,r){return e(r={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&r.path)}},r.exports),r.exports}var T=function(...e){try{return JSON.stringify.apply(null,e)}catch(e){return"[Cannot display object: "+e.message+"]"}},k=P((function(e,t){e.exports=class extends Error{constructor(e){super(e.filter((e=>""!==e)).map((e=>"string"==typeof e?e:e instanceof Error?e.message:T(e))).join(" ")||"Unknown error"),"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,t.assert)}}})),B=function(e,...t){if(!e){if(1===t.length&&t[0]instanceof Error)throw t[0];throw new k(t)}};const M={};var I=function(e,t,r){if(!1===t||null==t)return e;"string"==typeof(r=r||{})&&(r={separator:r});const n=Array.isArray(t);B(!n||!r.separator,"Separator option no valid for array-based chain");const o=n?t:t.split(r.separator||".");let a=e;for(let e=0;e<o.length;++e){let n=o[e];const i=r.iterables&&M.iterables(a);if(Array.isArray(a)||"set"===i){const e=Number(n);Number.isInteger(e)&&(n=e<0?a.length+e:e)}if(!a||"function"==typeof a&&!1===r.functions||!i&&void 0===a[n]){B(!r.strict||e+1===o.length,"Missing segment",n,"in reach path ",t),B("object"==typeof a||!0===r.functions||"function"!=typeof a,"Invalid segment",n,"in reach path ",t),a=r.default;break}a=i?"set"===i?[...a][n]:a.get(n):a[n]}return a};M.iterables=function(e){return e instanceof Set?"set":e instanceof Map?"map":void 0};var $=P((function(e,t){const r={};t=e.exports={array:Array.prototype,buffer:Buffer&&Buffer.prototype,date:Date.prototype,error:Error.prototype,generic:Object.prototype,map:Map.prototype,promise:Promise.prototype,regex:RegExp.prototype,set:Set.prototype,weakMap:WeakMap.prototype,weakSet:WeakSet.prototype},r.typeMap=new Map([["[object Error]",t.error],["[object Map]",t.map],["[object Promise]",t.promise],["[object Set]",t.set],["[object WeakMap]",t.weakMap],["[object WeakSet]",t.weakSet]]),t.getInternalProto=function(e){if(Array.isArray(e))return t.array;if(Buffer&&e instanceof Buffer)return t.buffer;if(e instanceof Date)return t.date;if(e instanceof RegExp)return t.regex;if(e instanceof Error)return t.error;const n=Object.prototype.toString.call(e);return r.typeMap.get(n)||t.generic}})),N=function(e,t={}){return!1!==t.symbols?Reflect.ownKeys(e):Object.getOwnPropertyNames(e)};const H={needsProtoHack:new Set([$.set,$.map,$.weakSet,$.weakMap])};var D=H.clone=function(e,t={},r=null){if("object"!=typeof e||null===e)return e;let n=H.clone,o=r;if(t.shallow){if(!0!==t.shallow)return H.cloneWithShallow(e,t);n=e=>e}else if(o){const t=o.get(e);if(t)return t}else o=new Map;const a=$.getInternalProto(e);if(a===$.buffer)return Buffer&&Buffer.from(e);if(a===$.date)return new Date(e.getTime());if(a===$.regex)return new RegExp(e);const i=H.base(e,a,t);if(i===e)return e;if(o&&o.set(e,i),a===$.set)for(const r of e)i.add(n(r,t,o));else if(a===$.map)for(const[r,a]of e)i.set(r,n(a,t,o));const s=N(e,t);for(const r of s){if("__proto__"===r)continue;if(a===$.array&&"length"===r){i.length=e.length;continue}const s=Object.getOwnPropertyDescriptor(e,r);s?s.get||s.set?Object.defineProperty(i,r,s):s.enumerable?i[r]=n(e[r],t,o):Object.defineProperty(i,r,{enumerable:!1,writable:!0,configurable:!0,value:n(e[r],t,o)}):Object.defineProperty(i,r,{enumerable:!0,writable:!0,configurable:!0,value:n(e[r],t,o)})}return i};H.cloneWithShallow=function(e,t){const r=t.shallow;(t=Object.assign({},t)).shallow=!1;const n=new Map;for(const t of r){const r=I(e,t);"object"!=typeof r&&"function"!=typeof r||n.set(r,r)}return H.clone(e,t,n)},H.base=function(e,t,r){if(!1===r.prototype)return H.needsProtoHack.has(t)?new t.constructor:t===$.array?[]:{};const n=Object.getPrototypeOf(e);if(n&&n.isImmutable)return e;if(t===$.array){const e=[];return n!==t&&Object.setPrototypeOf(e,n),e}if(H.needsProtoHack.has(t)){const e=new n.constructor;return n!==t&&Object.setPrototypeOf(e,n),e}return Object.create(n)};const L={};var z=L.merge=function(e,t,r){if(B(e&&"object"==typeof e,"Invalid target value: must be an object"),B(null==t||"object"==typeof t,"Invalid source value: must be null, undefined, or an object"),!t)return e;if(r=Object.assign({nullOverride:!0,mergeArrays:!0},r),Array.isArray(t)){B(Array.isArray(e),"Cannot merge array onto an object"),r.mergeArrays||(e.length=0);for(let n=0;n<t.length;++n)e.push(D(t[n],{symbols:r.symbols}));return e}const n=N(t,r);for(let o=0;o<n.length;++o){const a=n[o];if("__proto__"===a||!Object.prototype.propertyIsEnumerable.call(t,a))continue;const i=t[a];if(i&&"object"==typeof i){if(e[a]===i)continue;!e[a]||"object"!=typeof e[a]||Array.isArray(e[a])!==Array.isArray(i)||i instanceof Date||Buffer&&Buffer.isBuffer(i)||i instanceof RegExp?e[a]=D(i,{symbols:r.symbols}):L.merge(e[a],i,r)}else(null!=i||r.nullOverride)&&(e[a]=i)}return e};const W={};W.applyToDefaultsWithShallow=function(e,t,r){const n=r.shallow;B(Array.isArray(n),"Invalid keys");const o=new Map,a=!0===t?null:new Set;for(let r of n){r=Array.isArray(r)?r:r.split(".");const n=I(e,r);n&&"object"==typeof n?o.set(n,a&&I(t,r)||n):a&&a.add(r)}const i=D(e,{},o);if(!a)return i;for(const e of a)W.reachCopy(i,t,e);return z(i,t,{mergeArrays:!1,nullOverride:!1})},W.reachCopy=function(e,t,r){for(const e of r){if(!(e in t))return;t=t[e]}const n=t;let o=e;for(let e=0;e<r.length-1;++e){const t=r[e];"object"!=typeof o[t]&&(o[t]={}),o=o[t]}o[r[r.length-1]]=n};const F={};var U=F.Bench=class{constructor(){this.ts=0,this.reset()}reset(){this.ts=F.Bench.now()}elapsed(){return F.Bench.now()-this.ts}static now(){const e=process.hrtime();return 1e3*e[0]+e[1]/1e6}},_=function(){};const G={mismatched:null};var V=function(e,t,r){return r=Object.assign({prototype:!0},r),!!G.isDeepEqual(e,t,r,[])};G.isDeepEqual=function(e,t,r,n){if(e===t)return 0!==e||1/e==1/t;const o=typeof e;if(o!==typeof t)return!1;if(null===e||null===t)return!1;if("function"===o){if(!r.deepFunction||e.toString()!==t.toString())return!1}else if("object"!==o)return e!=e&&t!=t;const a=G.getSharedType(e,t,!!r.prototype);switch(a){case $.buffer:return Buffer&&Buffer.prototype.equals.call(e,t);case $.promise:return e===t;case $.regex:return e.toString()===t.toString();case G.mismatched:return!1}for(let r=n.length-1;r>=0;--r)if(n[r].isSame(e,t))return!0;n.push(new G.SeenEntry(e,t));try{return!!G.isDeepEqualObj(a,e,t,r,n)}finally{n.pop()}},G.getSharedType=function(e,t,r){if(r)return Object.getPrototypeOf(e)!==Object.getPrototypeOf(t)?G.mismatched:$.getInternalProto(e);const n=$.getInternalProto(e);return n!==$.getInternalProto(t)?G.mismatched:n},G.valueOf=function(e){const t=e.valueOf;if(void 0===t)return e;try{return t.call(e)}catch(e){return e}},G.hasOwnEnumerableProperty=function(e,t){return Object.prototype.propertyIsEnumerable.call(e,t)},G.isSetSimpleEqual=function(e,t){for(const r of Set.prototype.values.call(e))if(!Set.prototype.has.call(t,r))return!1;return!0},G.isDeepEqualObj=function(e,t,r,n,o){const{isDeepEqual:a,valueOf:i,hasOwnEnumerableProperty:s}=G,{keys:u,getOwnPropertySymbols:c}=Object;if(e===$.array){if(!n.part){if(t.length!==r.length)return!1;for(let e=0;e<t.length;++e)if(!a(t[e],r[e],n,o))return!1;return!0}for(const e of t)for(const t of r)if(a(e,t,n,o))return!0}else if(e===$.set){if(t.size!==r.size)return!1;if(!G.isSetSimpleEqual(t,r)){const e=new Set(Set.prototype.values.call(r));for(const r of Set.prototype.values.call(t)){if(e.delete(r))continue;let t=!1;for(const i of e)if(a(r,i,n,o)){e.delete(i),t=!0;break}if(!t)return!1}}}else if(e===$.map){if(t.size!==r.size)return!1;for(const[e,i]of Map.prototype.entries.call(t)){if(void 0===i&&!Map.prototype.has.call(r,e))return!1;if(!a(i,Map.prototype.get.call(r,e),n,o))return!1}}else if(e===$.error&&(t.name!==r.name||t.message!==r.message))return!1;const f=i(t),l=i(r);if((t!==f||r!==l)&&!a(f,l,n,o))return!1;const p=u(t);if(!n.part&&p.length!==u(r).length&&!n.skip)return!1;let d=0;for(const e of p)if(n.skip&&n.skip.includes(e))void 0===r[e]&&++d;else{if(!s(r,e))return!1;if(!a(t[e],r[e],n,o))return!1}if(!n.part&&p.length-d!==u(r).length)return!1;if(!1!==n.symbols){const e=c(t),i=new Set(c(r));for(const u of e){if(!n.skip||!n.skip.includes(u))if(s(t,u)){if(!s(r,u))return!1;if(!a(t[u],r[u],n,o))return!1}else if(s(r,u))return!1;i.delete(u)}for(const e of i)if(s(r,e))return!1}return!0},G.SeenEntry=class{constructor(e,t){this.obj=e,this.ref=t}isSame(e,t){return this.obj===e&&this.ref===t}};var K=function(e){return e.replace(/[\^\$\.\*\+\-\?\=\!\:\|\\\/\(\)\[\]\{\}\,]/g,"\\$&")};const J={};J.array=function(e,t,r){if(Array.isArray(t)||(t=[t]),!e.length)return!1;if(r.only&&r.once&&e.length!==t.length)return!1;let n;const o=new Map;for(const e of t)if(r.deep&&e&&"object"==typeof e){n=n||J.compare(r);let t=!1;for(const[r,a]of o.entries())if(n(r,e)){++a.allowed,t=!0;break}t||o.set(e,{allowed:1,hits:0})}else{const t=o.get(e);t?++t.allowed:o.set(e,{allowed:1,hits:0})}let a=0;for(const t of e){let e;if(r.deep&&t&&"object"==typeof t){n=n||J.compare(r);for(const[r,a]of o.entries())if(n(r,t)){e=a;break}}else e=o.get(t);if(e&&(++e.hits,++a,r.once&&e.hits>e.allowed))return!1}if(r.only&&a!==e.length)return!1;for(const e of o.values())if(e.hits!==e.allowed&&e.hits<e.allowed&&!r.part)return!1;return!!a},J.object=function(e,t,r){B(void 0===r.once,"Cannot use option once with object");const n=N(e,r);if(!n.length)return!1;if(Array.isArray(t))return J.array(n,t,r);const o=Object.getOwnPropertySymbols(t).filter((e=>t.propertyIsEnumerable(e))),a=[...Object.keys(t),...o],i=J.compare(r),s=new Set(a);for(const o of n)if(s.has(o)){if(!i(t[o],e[o]))return!1;s.delete(o)}else if(r.only)return!1;return!s.size||!!r.part&&s.size<a.length},J.string=function(e,t,r){if(""===e)return 1===t.length&&""===t[0]||!r.once&&!t.some((e=>""!==e));const n=new Map,o=[];for(const e of t)if(B("string"==typeof e,"Cannot compare string reference to non-string value"),e){const t=n.get(e);t?++t.allowed:(n.set(e,{allowed:1,hits:0}),o.push(K(e)))}else if(r.once||r.only)return!1;if(!o.length)return!0;const a=new RegExp(`(${o.join("|")})`,"g"),i=e.replace(a,((e,t)=>(++n.get(t).hits,"")));if(r.only&&i)return!1;let s=!1;for(const e of n.values())if(e.hits&&(s=!0),e.hits!==e.allowed){if(e.hits<e.allowed&&!r.part)return!1;if(r.once)return!1}return!!s},J.compare=function(e){if(!e.deep)return J.shallow;const t=void 0!==e.only,r=void 0!==e.part,n={prototype:t?e.only:!!r&&!e.part,part:t?!e.only:!!r&&e.part};return(e,t)=>V(e,t,n)},J.shallow=function(e,t){return e===t};const Q={};Q.escapeHtmlChar=function(e){const t=Q.namedHtml[e];if(void 0!==t)return t;if(e>=256)return"&#"+e+";";return`&#x${e.toString(16).padStart(2,"0")};`},Q.isSafe=function(e){return void 0!==Q.safeCharCodes[e]},Q.namedHtml={38:"&amp;",60:"&lt;",62:"&gt;",34:"&quot;",160:"&nbsp;",162:"&cent;",163:"&pound;",164:"&curren;",169:"&copy;",174:"&reg;"},Q.safeCharCodes=function(){const e={};for(let t=32;t<123;++t)(t>=97||t>=65&&t<=90||t>=48&&t<=57||32===t||46===t||44===t||45===t||58===t||95===t)&&(e[t]=null);return e}();const X={};var Y=X.flatten=function(e,t){const r=t||[];for(let t=0;t<e.length;++t)Array.isArray(e[t])?X.flatten(e[t],r):r.push(e[t]);return r};const Z={};Z.has=function(e,t){return"function"==typeof e.has?e.has(t):void 0!==e[t]};var ee={applyToDefaults:function(e,t,r={}){if(B(e&&"object"==typeof e,"Invalid defaults value: must be an object"),B(!t||!0===t||"object"==typeof t,"Invalid source value: must be true, falsy or an object"),B("object"==typeof r,"Invalid options: must be an object"),!t)return null;if(r.shallow)return W.applyToDefaultsWithShallow(e,t,r);const n=D(e);if(!0===t)return n;const o=void 0!==r.nullOverride&&r.nullOverride;return z(n,t,{nullOverride:o,mergeArrays:!1})},assert:B,Bench:U,block:function(){return new Promise(_)},clone:D,contain:function(e,t,r={}){return"object"!=typeof t&&(t=[t]),B(!Array.isArray(t)||t.length,"Values array cannot be empty"),"string"==typeof e?J.string(e,t,r):Array.isArray(e)?J.array(e,t,r):(B("object"==typeof e,"Reference must be string or an object"),J.object(e,t,r))},deepEqual:V,Error:k,escapeHeaderAttribute:function(e){return B(/^[ \w\!#\$%&'\(\)\*\+,\-\.\/\:;<\=>\?@\[\]\^`\{\|\}~\"\\]*$/.test(e),"Bad attribute value ("+e+")"),e.replace(/\\/g,"\\\\").replace(/\"/g,'\\"')},escapeHtml:function(e){if(!e)return"";let t="";for(let r=0;r<e.length;++r){const n=e.charCodeAt(r);Q.isSafe(n)?t+=e[r]:t+=Q.escapeHtmlChar(n)}return t},escapeJson:function(e){if(!e)return"";let t;return e.replace(/[<>&\u2028\u2029]/g,(e=>(t=e.charCodeAt(0),60===t?"\\u003c":62===t?"\\u003e":38===t?"\\u0026":8232===t?"\\u2028":"\\u2029")))},escapeRegex:K,flatten:Y,ignore:_,intersect:function(e,t,r={}){if(!e||!t)return r.first?null:[];const n=[],o=Array.isArray(e)?new Set(e):e,a=new Set;for(const e of t)if(Z.has(o,e)&&!a.has(e)){if(r.first)return e;n.push(e),a.add(e)}return r.first?null:n},isPromise:function(e){return!!e&&"function"==typeof e.then},merge:z,once:function(e){if(e._hoekOnce)return e;let t=!1;const r=function(...r){t||(t=!0,e(...r))};return r._hoekOnce=!0,r},reach:I,reachTemplate:function(e,t,r){return t.replace(/{([^}]+)}/g,((t,n)=>{const o=I(e,n,r);return null==o?"":o}))},stringify:T,wait:function(e,t){if("number"!=typeof e&&void 0!==e)throw new TypeError("Timeout must be a number");return new Promise((r=>setTimeout(r,e,t)))}},te=P((function(e,t){const r={codes:new Map([[100,"Continue"],[101,"Switching Protocols"],[102,"Processing"],[200,"OK"],[201,"Created"],[202,"Accepted"],[203,"Non-Authoritative Information"],[204,"No Content"],[205,"Reset Content"],[206,"Partial Content"],[207,"Multi-Status"],[300,"Multiple Choices"],[301,"Moved Permanently"],[302,"Moved Temporarily"],[303,"See Other"],[304,"Not Modified"],[305,"Use Proxy"],[307,"Temporary Redirect"],[400,"Bad Request"],[401,"Unauthorized"],[402,"Payment Required"],[403,"Forbidden"],[404,"Not Found"],[405,"Method Not Allowed"],[406,"Not Acceptable"],[407,"Proxy Authentication Required"],[408,"Request Time-out"],[409,"Conflict"],[410,"Gone"],[411,"Length Required"],[412,"Precondition Failed"],[413,"Request Entity Too Large"],[414,"Request-URI Too Large"],[415,"Unsupported Media Type"],[416,"Requested Range Not Satisfiable"],[417,"Expectation Failed"],[418,"I'm a teapot"],[422,"Unprocessable Entity"],[423,"Locked"],[424,"Failed Dependency"],[425,"Too Early"],[426,"Upgrade Required"],[428,"Precondition Required"],[429,"Too Many Requests"],[431,"Request Header Fields Too Large"],[451,"Unavailable For Legal Reasons"],[500,"Internal Server Error"],[501,"Not Implemented"],[502,"Bad Gateway"],[503,"Service Unavailable"],[504,"Gateway Time-out"],[505,"HTTP Version Not Supported"],[506,"Variant Also Negotiates"],[507,"Insufficient Storage"],[509,"Bandwidth Limit Exceeded"],[510,"Not Extended"],[511,"Network Authentication Required"]])};t.Boom=class extends Error{constructor(e,n={}){if(e instanceof Error)return t.boomify(ee.clone(e),n);const{statusCode:o=500,data:a=null,ctor:i=t.Boom}=n,s=new Error(e||void 0);Error.captureStackTrace(s,i),s.data=a;const u=r.initialize(s,o);return Object.defineProperty(u,"typeof",{value:i}),n.decorate&&Object.assign(u,n.decorate),u}static[Symbol.hasInstance](e){return t.isBoom(e)}},t.isBoom=function(e,t){return e instanceof Error&&!!e.isBoom&&(!t||e.output.statusCode===t)},t.boomify=function(e,t){return ee.assert(e instanceof Error,"Cannot wrap non-Error object"),void 0!==(t=t||{}).data&&(e.data=t.data),t.decorate&&Object.assign(e,t.decorate),e.isBoom?!1===t.override||!t.statusCode&&!t.message?e:r.initialize(e,t.statusCode||e.output.statusCode,t.message):r.initialize(e,t.statusCode||500,t.message)},t.badRequest=function(e,r){return new t.Boom(e,{statusCode:400,data:r,ctor:t.badRequest})},t.unauthorized=function(e,r,n){const o=new t.Boom(e,{statusCode:401,ctor:t.unauthorized});if(!r)return o;if("string"!=typeof r)return o.output.headers["WWW-Authenticate"]=r.join(", "),o;let a=""+r;return(n||e)&&(o.output.payload.attributes={}),n&&("string"==typeof n?(a+=" "+ee.escapeHeaderAttribute(n),o.output.payload.attributes=n):a+=" "+Object.keys(n).map((e=>{let t=n[e];return null==t&&(t=""),o.output.payload.attributes[e]=t,`${e}="${ee.escapeHeaderAttribute(t.toString())}"`})).join(", ")),e?(n&&(a+=","),a+=` error="${ee.escapeHeaderAttribute(e)}"`,o.output.payload.attributes.error=e):o.isMissing=!0,o.output.headers["WWW-Authenticate"]=a,o},t.paymentRequired=function(e,r){return new t.Boom(e,{statusCode:402,data:r,ctor:t.paymentRequired})},t.forbidden=function(e,r){return new t.Boom(e,{statusCode:403,data:r,ctor:t.forbidden})},t.notFound=function(e,r){return new t.Boom(e,{statusCode:404,data:r,ctor:t.notFound})},t.methodNotAllowed=function(e,r,n){const o=new t.Boom(e,{statusCode:405,data:r,ctor:t.methodNotAllowed});return"string"==typeof n&&(n=[n]),Array.isArray(n)&&(o.output.headers.Allow=n.join(", ")),o},t.notAcceptable=function(e,r){return new t.Boom(e,{statusCode:406,data:r,ctor:t.notAcceptable})},t.proxyAuthRequired=function(e,r){return new t.Boom(e,{statusCode:407,data:r,ctor:t.proxyAuthRequired})},t.clientTimeout=function(e,r){return new t.Boom(e,{statusCode:408,data:r,ctor:t.clientTimeout})},t.conflict=function(e,r){return new t.Boom(e,{statusCode:409,data:r,ctor:t.conflict})},t.resourceGone=function(e,r){return new t.Boom(e,{statusCode:410,data:r,ctor:t.resourceGone})},t.lengthRequired=function(e,r){return new t.Boom(e,{statusCode:411,data:r,ctor:t.lengthRequired})},t.preconditionFailed=function(e,r){return new t.Boom(e,{statusCode:412,data:r,ctor:t.preconditionFailed})},t.entityTooLarge=function(e,r){return new t.Boom(e,{statusCode:413,data:r,ctor:t.entityTooLarge})},t.uriTooLong=function(e,r){return new t.Boom(e,{statusCode:414,data:r,ctor:t.uriTooLong})},t.unsupportedMediaType=function(e,r){return new t.Boom(e,{statusCode:415,data:r,ctor:t.unsupportedMediaType})},t.rangeNotSatisfiable=function(e,r){return new t.Boom(e,{statusCode:416,data:r,ctor:t.rangeNotSatisfiable})},t.expectationFailed=function(e,r){return new t.Boom(e,{statusCode:417,data:r,ctor:t.expectationFailed})},t.teapot=function(e,r){return new t.Boom(e,{statusCode:418,data:r,ctor:t.teapot})},t.badData=function(e,r){return new t.Boom(e,{statusCode:422,data:r,ctor:t.badData})},t.locked=function(e,r){return new t.Boom(e,{statusCode:423,data:r,ctor:t.locked})},t.failedDependency=function(e,r){return new t.Boom(e,{statusCode:424,data:r,ctor:t.failedDependency})},t.tooEarly=function(e,r){return new t.Boom(e,{statusCode:425,data:r,ctor:t.tooEarly})},t.preconditionRequired=function(e,r){return new t.Boom(e,{statusCode:428,data:r,ctor:t.preconditionRequired})},t.tooManyRequests=function(e,r){return new t.Boom(e,{statusCode:429,data:r,ctor:t.tooManyRequests})},t.illegal=function(e,r){return new t.Boom(e,{statusCode:451,data:r,ctor:t.illegal})},t.internal=function(e,n,o=500){return r.serverError(e,n,o,t.internal)},t.notImplemented=function(e,n){return r.serverError(e,n,501,t.notImplemented)},t.badGateway=function(e,n){return r.serverError(e,n,502,t.badGateway)},t.serverUnavailable=function(e,n){return r.serverError(e,n,503,t.serverUnavailable)},t.gatewayTimeout=function(e,n){return r.serverError(e,n,504,t.gatewayTimeout)},t.badImplementation=function(e,n){const o=r.serverError(e,n,500,t.badImplementation);return o.isDeveloperError=!0,o},r.initialize=function(e,t,n){const o=parseInt(t,10);if(ee.assert(!isNaN(o)&&o>=400,"First argument must be a number (400+):",t),e.isBoom=!0,e.isServer=o>=500,e.hasOwnProperty("data")||(e.data=null),e.output={statusCode:o,payload:{},headers:{}},Object.defineProperty(e,"reformat",{value:r.reformat}),n||e.message||(e.reformat(),n=e.output.payload.error),n){const t=Object.getOwnPropertyDescriptor(e,"message")||Object.getOwnPropertyDescriptor(Object.getPrototypeOf(e),"message");ee.assert(!t||t.configurable&&!t.get,"The error is not compatible with boom"),e.message=n+(e.message?": "+e.message:""),e.output.payload.message=e.message}return e.reformat(),e},r.reformat=function(e=!1){this.output.payload.statusCode=this.output.statusCode,this.output.payload.error=r.codes.get(this.output.statusCode)||"Unknown",500===this.output.statusCode&&!0!==e?this.output.payload.message="An internal server error occurred":this.message&&(this.output.payload.message=this.message)},r.serverError=function(e,r,n,o){return r instanceof Error&&!r.isBoom?t.boomify(r,{statusCode:n,message:e}):new t.Boom(e,{statusCode:n,data:r,ctor:o})}})),re=P((function(e,t){const r={};t.selection=function(e,r,n){const o=t.selections(e,r,n);return o.length?o[0]:""},t.selections=function(e,t,n){return ee.assert(!t||Array.isArray(t),"Preferences must be an array"),r.parse(e||"",t,n)},r.parse=function(e,t,n){const o=e.replace(/[ \t]/g,""),a=new Map;if(t)for(let e=0;e<t.length;++e){const r=t[e];a.set(r.toLowerCase(),{orig:r,pos:e})}const i=o.split(","),s=[],u=new Set;for(let e=0;e<i.length;++e){const r=i[e];if(!r)continue;const o=r.split(";");if(o.length>2)throw te.badRequest(`Invalid ${n.type} header`);let c=o[0].toLowerCase();if(!c)throw te.badRequest(`Invalid ${n.type} header`);n.equivalents&&n.equivalents.has(c)&&(c=n.equivalents.get(c));const f={token:c,pos:e,q:1,specificity:n.specificity?c.split("-"):null};if(t&&a.has(c)&&(f.pref=a.get(c).pos),u.add(f.token),2===o.length){const e=o[1],[t,r]=e.split("=");if(!r||"q"!==t&&"Q"!==t)throw te.badRequest(`Invalid ${n.type} header`);const a=parseFloat(r);if(0===a)continue;Number.isFinite(a)&&a<=1&&a>=.001&&(f.q=a)}s.push(f)}s.sort(r.sort);const c=s.map((e=>e.token));if(n.default&&!u.has(n.default)&&c.push(n.default),!t||!t.length)return c;const f=[];for(const e of c)if("*"===e)for(const[e,t]of a)u.has(e)||f.push(t.orig);else{const t=e.toLowerCase();a.has(t)&&f.push(a.get(t).orig)}return f},r.sort=function(e,t){return t.q!==e.q?t.q-e.q:t.pref!==e.pref?void 0===e.pref?1:void 0===t.pref?-1:e.pref-t.pref:e.specificity&&e.specificity[0]===t.specificity[0]&&e.specificity.length!==t.specificity.length?t.specificity.length-e.specificity.length:e.pos-t.pos}})),ne=P((function(e,t){const r={};t.selection=function(e,r){const n=t.selections(e,r);return n.length?n[0]:""},t.selections=function(e,t){return ee.assert(!t||Array.isArray(t),"Preferences must be an array"),r.parse(e,t)},r.validMediaRx=/^(?:\*\/\*)|(?:[\w\!#\$%&'\*\+\-\.\^`\|~]+\/\*)|(?:[\w\!#\$%&'\*\+\-\.\^`\|~]+\/[\w\!#\$%&'\*\+\-\.\^`\|~]+)$/,r.parse=function(e,t){const{header:n,quoted:o}=r.normalize(e),a=n.split(","),i=[],s={};for(let e=0;e<a.length;++e){const t=a[e];if(!t)continue;const n=t.split(";"),u=n.shift().toLowerCase();if(!r.validMediaRx.test(u))continue;const c={token:u,params:{},exts:{},pos:e};let f="params";for(const e of n){const t=e.split("=");if(2!==t.length||!t[1])throw te.badRequest("Invalid accept header");const r=t[0];let n=t[1];"q"===r||"Q"===r?(f="exts",n=parseFloat(n),(!Number.isFinite(n)||n>1||n<.001&&0!==n)&&(n=1),c.q=n):('"'===n[0]&&(n=`"${o[n]}"`),c[f][t[0]]=n)}const l=Object.keys(c.params);c.original=[""].concat(l.map((e=>`${e}=${c.params[e]}`))).join(";"),c.specificity=l.length,void 0===c.q&&(c.q=1);const p=c.token.split("/");c.type=p[0],c.subtype=p[1],s[c.token]=c,c.q&&i.push(c)}return i.sort(r.sort),r.preferences(s,i,t)},r.normalize=function(e){const t={header:e=e||"*/*",quoted:{}};if(e.includes('"')){let r=0;t.header=e.replace(/="([^"]*)"/g,((e,n)=>{const o='"'+ ++r;return t.quoted[o]=n,"="+o}))}return t.header=t.header.replace(/[ \t]/g,""),t},r.sort=function(e,t){return t.q!==e.q?t.q-e.q:e.type!==t.type?r.innerSort(e,t,"type"):e.subtype!==t.subtype?r.innerSort(e,t,"subtype"):e.specificity!==t.specificity?t.specificity-e.specificity:e.pos-t.pos},r.innerSort=function(e,t,r){return"*"===e[r]?1:"*"===t[r]||e[r]<t[r]?-1:1},r.preferences=function(e,t,r){if(!r||!r.length)return t.map((e=>e.token+e.original));const n=Object.create(null),o=Object.create(null);let a=!1;for(const e of r){const t=e.toLowerCase();o[t]=e;const r=t.split("/"),i=r[0],s=r[1];"*"!==i?(n[i]=n[i]||Object.create(null),n[i][s]=e):(ee.assert("*"===s,"Invalid media type preference contains wildcard type with a subtype"),a=!0)}const i=[];for(const r of t){const t=r.token,{type:s,subtype:u}=e[t],c=n[s];if("*"!==s)if(a)i.push((o[t]||t)+r.original);else if("*"===u){if(c)for(const t of Object.keys(c))e[`${s}/${t}`]||i.push(c[t])}else{const e=o[t];(e||c&&c["*"])&&i.push((e||t)+r.original)}else{for(const t of Object.keys(o))e[t]||i.push(o[t]);a&&i.push("*/*")}}return i}}));function oe(e,t,r){let n;if(t){const[r,o]=e.split("?");n=`${r}?${t}${o?"&"+o:""}`}else n=e;const o=r.toString();return{status:o,statusDescription:p.STATUS_CODES[o],headers:{location:[{key:"Location",value:n}],refresh:308===r?[{key:"Refresh",value:"0;url="+n}]:[]}}}P((function(e,t){const r={options:{charset:{type:"accept-charset"},encoding:{type:"accept-encoding",default:"identity",equivalents:new Map([["x-compress","compress"],["x-gzip","gzip"]])},language:{type:"accept-language",specificity:!0}}};for(const e in r.options)t[e]=(t,n)=>re.selection(t,n,r.options[e]),t[e+"s"]=(t,n)=>re.selections(t,n,r.options[e]);t.mediaType=(e,t)=>ne.selection(e,t),t.mediaTypes=(e,t)=>ne.selections(e,t),t.parseAll=function(e){return{charsets:t.charsets(e["accept-charset"]),encodings:t.encodings(e["accept-encoding"]),languages:t.languages(e["accept-language"]),mediaTypes:t.mediaTypes(e.accept)}}}));const ae=["connection","expect","keep-alive","proxy-authenticate","proxy-authorization","proxy-connection","trailer","upgrade","x-accel-buffering","x-accel-charset","x-accel-limit-rate","x-accel-redirect","x-cache","x-forwarded-proto","x-real-ip","content-length","host","transfer-encoding","via"],ie=["x-amz-cf-","x-amzn-","x-edge-"];function se(e){const t=e.toLowerCase();for(const e of ie)if(t.startsWith(e))return!0;return ae.includes(t)}const ue=["connection","expect","keep-alive","proxy-authenticate","proxy-authorization","proxy-connection","trailer","upgrade","x-accel-buffering","x-accel-charset","x-accel-limit-rate","x-accel-redirect","x-cache","x-forwarded-proto","x-real-ip"],ce=["x-amz-cf-","x-amzn-","x-edge-"];function fe(e){const t=e.toLowerCase();for(const e of ce)if(t.startsWith(e))return!0;return ue.includes(t)}const le=u.default.basePath,pe=e=>(e.startsWith(le)&&(e=e.slice(le.length)),e),de=e=>{const{apis:{dynamic:t,nonDynamic:r}}=e;return e=>{if(le&&e.startsWith(le)&&(e=e.slice(le.length)),r[e])return r[e];for(const r in t){const{file:n,regex:o}=t[r];if(new RegExp(o,"i").test(e))return n}return null}};exports.handler=async e=>{var t;const r=e.Records[0].cf.request,n=u.default,o=s.default,a=r.headers.authorization,i=function(e,t){if(t&&t.username&&t.password&&e!=="Basic "+Buffer.from(t.username+":"+t.password).toString("base64"))return{status:"401",statusDescription:"Unauthorized",body:"Unauthorized",headers:{"www-authenticate":[{key:"WWW-Authenticate",value:"Basic"}]}};return null}(a?a[0].value:null,s.default.authentication);if(i)return i;const c=function(e,t){const r=e.headers.host;if(r&&r.length>0){const n=r[0].value,o=t.domainRedirects;if(o&&o[n])return`${o[n]}${e.uri}`}return null}(r,o);if(c)return oe(c,r.querystring,308);const f=function(e,t){e=A(e,t);const r=t.redirects;for(const t of r){const r=q(e,t.source);if(r){const e=O(t.destination,r.params);return e?{redirectPath:e,statusCode:t.statusCode}:null}}return null}(r.uri,n);if(f)return oe(f.redirectPath,r.querystring,f.statusCode);let l=o.apis.nonDynamic[pe(r.uri)],p=pe(r.uri);if(p=R(p,n),!l){const o=function(e,t,r,n){e=A(e,t);const o=t.rewrites;for(const a of o){const o=q(e,a.source);if(o){let i=O(a.destination,o.params);if(e===i){const e=r(n);if("pages/404.html"===e||"pages/_error.js"===e)continue}if(i&&S(e,t)){const e=Object.keys(o.params).filter((e=>"nextInternalLocale"!==e)).map((e=>{const t=o.params[e];return"string"==typeof t?`${e}=${t}`:t.map((t=>`${e}=${t}`)).join("&")})).filter((e=>e)).join("&");e&&(i+=i.includes("?")?"&"+e:"?"+e)}return i}}return null}(r.uri,n,de(s.default),p);if(o){const[a,i]=o.split("?");if(r.querystring?r.querystring=`${r.querystring}${i?"&"+i:""}`:r.querystring=""+(null!=i?i:""),function(e){return e.startsWith("http://")||e.startsWith("https://")}(o)){const{req:n,res:o,responsePromise:i}=g(e.Records[0].cf,{enableHTTPCompression:s.default.enableHTTPCompression});return await async function(e,t,r,n){const{default:o}=await Promise.resolve().then((function(){return require("./index-9e574644.js")}));let a,i={};if(Object.assign(i,t.headers),i.hasOwnProperty("host")&&delete i.host,n){const r=Buffer.from(n,"base64").toString("utf8");a=await o(e,{headers:i,method:t.method,body:r,compress:!1,redirect:"manual"})}else a=await o(e,{headers:i,method:t.method,compress:!1,redirect:"manual"});for(const[e,t]of a.headers.entries())se(e)||r.setHeader(e,t);r.statusCode=a.status,r.end(await a.buffer())}(a+(r.querystring?"?":"")+r.querystring,n,o,null===(t=r.body)||void 0===t?void 0:t.data),await i}r.uri=a,p=pe(r.uri),p=R(p,n)}}const d=de(s.default)(p);if(!d)return{status:"404"};const y=require("./"+d),{req:h,res:m,responsePromise:b}=g(e.Records[0].cf,{enableHTTPCompression:o.enableHTTPCompression});y.default(h,m);const w=await b;return function(e,t,r){if(e=A(e,r),t.headers)for(const n of r.headers)if(q(e,n.source))for(const e of n.headers)if(e.key&&e.value){const r=e.key.toLowerCase();t.headers[r]=[{key:r,value:e.value}]}}(r.uri,w,n),w.headers&&function(e){for(const t in e)fe(t)&&delete e[t]}(w.headers),w};
