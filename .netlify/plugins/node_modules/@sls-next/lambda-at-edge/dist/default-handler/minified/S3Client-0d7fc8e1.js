"use strict";var e=require("./httpRequest-79d7914f.js"),t=require("url"),r=require("buffer"),n=require("http"),a=require("fs"),o=require("os"),i=require("path"),s=require("child_process"),u=require("./default-handler-1d169422.js"),c=require("stream"),f=require("crypto"),l=require("./configurations-53dc2b78.js"),d=require("https");require("http2");var h=require("process"),v=require("./lazy-json-37175b28.js");function p(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}require("./prerender-manifest.json"),require("./manifest.json"),require("./routes-manifest.json"),require("zlib"),require("perf_hooks"),require("util");var g=p(h),_="@aws-sdk/client-s3",y="1.0.0-rc.3",w=function(e){var t=e.endpoint,r=e.urlParser;if("string"==typeof t){var n=Promise.resolve(r(t));return function(){return n}}if("object"==typeof t){var a=Promise.resolve(t);return function(){return a}}return t},m=function(t){return e.__awaiter(void 0,void 0,void 0,(function(){var r,n,a,o,i;return e.__generator(this,(function(e){switch(e.label){case 0:return r=t.tls,n=void 0===r||r,[4,t.region()];case 1:if(a=e.sent(),!new RegExp(/^([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9-]{0,61}[a-zA-Z0-9])$/).test(a))throw new Error("Invalid region in client config");return[4,t.regionInfoProvider(a)];case 2:if(!(o=(null!==(i=e.sent())&&void 0!==i?i:{}).hostname))throw new Error("Cannot resolve hostname from client config");return[2,t.urlParser((n?"https:":"http:")+"//"+o)]}}))}))},b={environmentVariableSelector:function(e){return e.AWS_REGION},configFileSelector:function(e){return e.region},default:function(){throw new Error("Region is missing")}},A=function(e){if("string"==typeof e){var t=Promise.resolve(e);return function(){return t}}return e},S=function(t){function r(e,r){void 0===r&&(r=!0);var n=t.call(this,e)||this;return n.tryNextLink=r,n}return e.__extends(r,t),r}(Error);function E(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return function(){var r,n,a=Promise.reject(new S("No providers in chain")),o=function(e){a=a.catch((function(t){if(null==t?void 0:t.tryNextLink)return e();throw t}))};try{for(var i=e.__values(t),s=i.next();!s.done;s=i.next()){o(s.value)}}catch(e){r={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a}}var k=function(t,r,n){var a,o;if(void 0===r)return function(){return o||(a=t(),o=!0),a};var i=!1;return function(){return e.__awaiter(void 0,void 0,void 0,(function(){var s;return e.__generator(this,(function(e){switch(e.label){case 0:return o||(a=t(),o=!0),i?[2,a]:[4,a];case 1:return s=e.sent(),n&&!n(s)?(i=!0,[2,s]):r(s)?[2,a=t()]:[2,s]}}))}))}};function O(t){return new Promise((function(a,o){var i=n.request(e.__assign({method:"GET"},t));i.on("error",(function(e){o(Object.assign(new S("Unable to connect to instance metadata service"),e))})),i.on("timeout",(function(){o(new Error("TimeoutError"))})),i.on("response",(function(e){var t=e.statusCode,n=void 0===t?400:t;(n<200||300<=n)&&o(Object.assign(new S("Error response received from instance metadata service"),{statusCode:n}));var i=[];e.on("data",(function(e){i.push(e)})),e.on("end",(function(){a(r.Buffer.concat(i))}))})),i.end()}))}var x=function(e){return Boolean(e)&&"object"==typeof e&&"string"==typeof e.AccessKeyId&&"string"==typeof e.SecretAccessKey&&"string"==typeof e.Token&&"string"==typeof e.Expiration},P=function(e){return{accessKeyId:e.AccessKeyId,secretAccessKey:e.SecretAccessKey,sessionToken:e.Token,expiration:new Date(e.Expiration)}},T=function(e){var t=e.maxRetries,r=void 0===t?0:t,n=e.timeout;return{maxRetries:r,timeout:void 0===n?1e3:n}},R=function(e,t){for(var r=e(),n=0;n<t;n++)r=r.catch(e);return r},C="AWS_CONTAINER_CREDENTIALS_FULL_URI",U="AWS_CONTAINER_CREDENTIALS_RELATIVE_URI";function I(r){var n=this;void 0===r&&(r={});var a=T(r),o=a.timeout,i=a.maxRetries;return function(){return function(){if(process.env[U])return Promise.resolve({hostname:"169.254.170.2",path:process.env[U]});if(process.env[C]){var r=t.parse(process.env[C]);return r.hostname&&r.hostname in j?r.protocol&&r.protocol in z?Promise.resolve(e.__assign(e.__assign({},r),{port:r.port?parseInt(r.port,10):void 0})):Promise.reject(new S(r.protocol+" is not a valid container metadata service protocol",!1)):Promise.reject(new S(r.hostname+" is not a valid container metadata service hostname",!1))}return Promise.reject(new S("The container metadata credential provider cannot be used unless the "+U+" or "+C+" environment variable is set",!1))}().then((function(t){return R((function(){return e.__awaiter(n,void 0,void 0,(function(){var r,n,a;return e.__generator(this,(function(e){switch(e.label){case 0:return a=(n=JSON).parse,[4,D(o,t)];case 1:if(r=a.apply(n,[e.sent()]),!x(r))throw new S("Invalid response received from instance metadata service.");return[2,P(r)]}}))}))}),i)}))}}function D(t,r){if(process.env.AWS_CONTAINER_AUTHORIZATION_TOKEN){var n=r.headers,a=void 0===n?{}:n;a.Authorization=process.env.AWS_CONTAINER_AUTHORIZATION_TOKEN,r.headers=a}return O(e.__assign(e.__assign({},r),{timeout:t})).then((function(e){return e.toString()}))}var j={localhost:!0,"127.0.0.1":!0},z={"http:":!0,"https:":!0};var q="169.254.169.254",N="/latest/meta-data/iam/security-credentials/",L=function(t){return e.__awaiter(void 0,void 0,void 0,(function(){return e.__generator(this,(function(r){return[2,O(e.__assign(e.__assign({},t),{host:q,path:"/latest/api/token",method:"PUT",headers:{"x-aws-ec2-metadata-token-ttl-seconds":"21600"}}))]}))}))},M=function(t){return e.__awaiter(void 0,void 0,void 0,(function(){return e.__generator(this,(function(r){switch(r.label){case 0:return[4,O(e.__assign(e.__assign({},t),{host:q,path:N}))];case 1:return[2,r.sent().toString()]}}))}))},H=function(t,r){return e.__awaiter(void 0,void 0,void 0,(function(){var n,a,o;return e.__generator(this,(function(i){switch(i.label){case 0:return o=(a=JSON).parse,[4,O(e.__assign(e.__assign({},r),{host:q,path:N+t}))];case 1:if(n=o.apply(a,[i.sent().toString()]),!x(n))throw new S("Invalid response received from instance metadata service.");return[2,P(n)]}}))}))},B=function(){return{}};function W(t){void 0===t&&(t={});var r=t.filepath,n=void 0===r?process.env.AWS_SHARED_CREDENTIALS_FILE||i.join(X(),".aws","credentials"):r,a=t.configFilepath,o=void 0===a?process.env.AWS_CONFIG_FILE||i.join(X(),".aws","config"):a;return Promise.all([G(o).then(V).then(K).catch(B),G(n).then(V).catch(B)]).then((function(t){var r=e.__read(t,2);return{configFile:r[0],credentialsFile:r[1]}}))}var F=/^profile\s(["'])?([^\1]+)\1$/;function K(t){var r,n,a={};try{for(var o=e.__values(Object.keys(t)),i=o.next();!i.done;i=o.next()){var s=i.value,u=void 0;if("default"===s)a.default=t.default;else if(u=F.exec(s)){var c=e.__read(u,3),f=(c[0],c[1],c[2]);f&&(a[f]=t[s])}}}catch(e){r={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return a}function V(t){var r,n,a,o={};try{for(var i=e.__values(t.split(/\r?\n/)),s=i.next();!s.done;s=i.next()){var u=s.value,c=(u=u.split(/(^|\s)[;#]/)[0]).match(/^\s*\[([^\[\]]+)]\s*$/);if(c)a=c[1];else if(a){var f=u.match(/^\s*(.+?)\s*=\s*(.+?)\s*$/);f&&(o[a]=o[a]||{},o[a][f[1]]=f[2])}}}catch(e){r={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return o}function G(e){return new Promise((function(t,r){a.readFile(e,"utf8",(function(e,n){e?r(e):t(n)}))}))}function X(){var e=process.env,t=e.HOME,r=e.USERPROFILE,n=e.HOMEPATH,a=e.HOMEDRIVE,s=void 0===a?"C:"+i.sep:a;return t||(r||(n?""+s+n:o.homedir()))}function $(e){return Boolean(e)&&"object"==typeof e&&"string"==typeof e.aws_access_key_id&&"string"==typeof e.aws_secret_access_key&&["undefined","string"].indexOf(typeof e.aws_session_token)>-1}function Z(e){return void 0===e&&(e={}),function(){return Q(e).then((function(t){return J(Y(e),t,e)}))}}function Y(e){return e.profile||process.env.AWS_PROFILE||"default"}function J(t,r,n,a){return void 0===a&&(a={}),e.__awaiter(this,void 0,void 0,(function(){var o,i,s,u,c,f,l,d,h,v,p,g,_;return e.__generator(this,(function(y){switch(y.label){case 0:if(o=r[t],Object.keys(a).length>0&&$(o))return[2,ee(o)];if(w=o,!(Boolean(w)&&"object"==typeof w&&"string"==typeof w.role_arn&&"string"==typeof w.source_profile&&["undefined","string"].indexOf(typeof w.role_session_name)>-1&&["undefined","string"].indexOf(typeof w.external_id)>-1&&["undefined","string"].indexOf(typeof w.mfa_serial)>-1))return[3,4];if(i=o.external_id,s=o.mfa_serial,u=o.role_arn,c=o.role_session_name,f=void 0===c?"aws-sdk-js-"+Date.now():c,l=o.source_profile,!n.roleAssumer)throw new S("Profile "+t+" requires a role to be assumed, but no role assumption callback was provided.",!1);if(l in a)throw new S("Detected a cycle attempting to resolve credentials for profile "+Y(n)+". Profiles visited: "+Object.keys(a).join(", "),!1);if(d=J(l,r,n,e.__assign(e.__assign({},a),((_={})[l]=!0,_))),h={RoleArn:u,RoleSessionName:f,ExternalId:i},!s)return[3,2];if(!n.mfaCodeProvider)throw new S("Profile "+t+" requires multi-factor authentication, but no MFA code callback was provided.",!1);return h.SerialNumber=s,v=h,[4,n.mfaCodeProvider(s)];case 1:v.TokenCode=y.sent(),y.label=2;case 2:return g=(p=n).roleAssumer,[4,d];case 3:return[2,g.apply(p,[y.sent(),h])];case 4:if($(o))return[2,ee(o)];throw new S("Profile "+t+" could not be found or parsed in shared credentials file.")}var w}))}))}function Q(t){var r=t.loadedConfig;return(void 0===r?W(t):r).then((function(t){var r=t.configFile,n=t.credentialsFile;return e.__assign(e.__assign({},r),n)}))}function ee(e){return Promise.resolve({accessKeyId:e.aws_access_key_id,secretAccessKey:e.aws_secret_access_key,sessionToken:e.aws_session_token})}function te(t){return void 0===t&&(t={}),function(){return Q(t).then((function(r){return function(t,r,n){return e.__awaiter(this,void 0,void 0,(function(){var n,a;return e.__generator(this,(function(e){switch(e.label){case 0:return n=r[t],r[t]?void 0===(a=n.credential_process)?[3,2]:[4,re(a).then((function(e){var r;try{r=JSON.parse(e)}catch(e){throw Error("Profile "+t+" credential_process returned invalid JSON.")}var n,a=r.Version,o=r.AccessKeyId,i=r.SecretAccessKey,s=r.SessionToken,u=r.Expiration;if(1!==a)throw Error("Profile "+t+" credential_process did not return Version 1.");if(void 0===o||void 0===i)throw Error("Profile "+t+" credential_process returned invalid credentials.");if(u){var c=new Date;if(new Date(u)<c)throw Error("Profile "+t+" credential_process returned expired credentials.");n=Math.floor(new Date(u).valueOf()/1e3)}return{accessKeyId:o,secretAccessKey:i,sessionToken:s,expirationUnix:n}})).catch((function(e){throw new S(e.message)}))]:[3,4];case 1:return[2,e.sent()];case 2:throw new S("Profile "+t+" did not contain credential_process.");case 3:return[3,5];case 4:throw new S("Profile "+t+" could not be found in shared credentials file.");case 5:return[2]}}))}))}(Y(t),r)}))}}function re(e){return new Promise((function(t,r){s.exec(e,(function(e,n){e?r(e):t(n.trim())}))}))}var ne=function(e,t){return(ne=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};var ae=function(){return(ae=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function oe(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function ie(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,a,o=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)i.push(n.value)}catch(e){a={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(a)throw a.error}}return i}function se(e){return this instanceof se?(this.v=e,this):new se(e)}for(var ue=Object.freeze({__proto__:null,__extends:function(e,t){function r(){this.constructor=e}ne(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},get __assign(){return ae},__rest:function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r},__decorate:function(e,t,r,n){var a,o=arguments.length,i=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(i=(o<3?a(i):o>3?a(t,r,i):a(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i},__param:function(e,t){return function(r,n){t(r,n,e)}},__metadata:function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter:function(e,t,r,n){return new(r||(r=Promise))((function(a,o){function i(e){try{u(n.next(e))}catch(e){o(e)}}function s(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,s)}u((n=n.apply(e,t||[])).next())}))},__generator:function(e,t){var r,n,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(a=2&o[0]?n.return:o[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,o[1])).done)return a;switch(n=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,n=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=i.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],n=0}finally{r=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},__createBinding:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]},__exportStar:function(e,t){for(var r in e)"default"===r||t.hasOwnProperty(r)||(t[r]=e[r])},__values:oe,__read:ie,__spread:function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(ie(arguments[t]));return e},__spreadArrays:function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),a=0;for(t=0;t<r;t++)for(var o=arguments[t],i=0,s=o.length;i<s;i++,a++)n[a]=o[i];return n},__await:se,__asyncGenerator:function(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,a=r.apply(e,t||[]),o=[];return n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n;function i(e){a[e]&&(n[e]=function(t){return new Promise((function(r,n){o.push([e,t,r,n])>1||s(e,t)}))})}function s(e,t){try{(r=a[e](t)).value instanceof se?Promise.resolve(r.value.v).then(u,c):f(o[0][2],r)}catch(e){f(o[0][3],e)}var r}function u(e){s("next",e)}function c(e){s("throw",e)}function f(e,t){e(t),o.shift(),o.length&&s(o[0][0],o[0][1])}},__asyncDelegator:function(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,a){t[n]=e[n]?function(t){return(r=!r)?{value:se(e[n](t)),done:"return"===n}:a?a(t):t}:a}},__asyncValues:function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=oe(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,a){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,a,(t=e[r](t)).done,t.value)}))}}},__makeTemplateObject:function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},__importStar:function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t},__importDefault:function(e){return e&&e.__esModule?e:{default:e}},__classPrivateFieldGet:function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)},__classPrivateFieldSet:function(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r}}),ce=u.createCommonjsModule((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Crc32=t.crc32=void 0,t.crc32=function(e){return(new r).update(e).digest()};var r=function(){function e(){this.checksum=4294967295}return e.prototype.update=function(e){var t,r;try{for(var a=ue.__values(e),o=a.next();!o.done;o=a.next()){var i=o.value;this.checksum=this.checksum>>>8^n[255&(this.checksum^i)]}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}return this},e.prototype.digest=function(){return(4294967295^this.checksum)>>>0},e}();t.Crc32=r;var n=Uint32Array.from([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117])})),fe={},le={},de=0;de<256;de++){var he=de.toString(16).toLowerCase();1===he.length&&(he="0"+he),fe[de]=he,le[he]=de}function ve(e){for(var t="",r=0;r<e.byteLength;r++)t+=fe[e[r]];return t}var pe=function(){function e(e){if(this.bytes=e,8!==e.byteLength)throw new Error("Int64 buffers must be exactly 8 bytes")}return e.fromNumber=function(t){if(t>0x8000000000000000||t<-0x8000000000000000)throw new Error(t+" is too large (or, if negative, too small) to represent as an Int64");for(var r=new Uint8Array(8),n=7,a=Math.abs(Math.round(t));n>-1&&a>0;n--,a/=256)r[n]=a;return t<0&&ge(r),new e(r)},e.prototype.valueOf=function(){var e=this.bytes.slice(0),t=128&e[0];return t&&ge(e),parseInt(ve(e),16)*(t?-1:1)},e.prototype.toString=function(){return String(this.valueOf())},e}();function ge(e){for(var t=0;t<8;t++)e[t]^=255;for(t=7;t>-1&&(e[t]++,0===e[t]);t--);}var _e,ye=function(){function t(e,t){this.toUtf8=e,this.fromUtf8=t}return t.prototype.format=function(t){var r,n,a,o,i=[];try{for(var s=e.__values(Object.keys(t)),u=s.next();!u.done;u=s.next()){var c=u.value,f=this.fromUtf8(c);i.push(Uint8Array.from([f.byteLength]),f,this.formatHeaderValue(t[c]))}}catch(e){r={error:e}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}var l=new Uint8Array(i.reduce((function(e,t){return e+t.byteLength}),0)),d=0;try{for(var h=e.__values(i),v=h.next();!v.done;v=h.next()){var p=v.value;l.set(p,d),d+=p.byteLength}}catch(e){a={error:e}}finally{try{v&&!v.done&&(o=h.return)&&o.call(h)}finally{if(a)throw a.error}}return l},t.prototype.formatHeaderValue=function(e){switch(e.type){case"boolean":return Uint8Array.from([e.value?0:1]);case"byte":return Uint8Array.from([2,e.value]);case"short":var t=new DataView(new ArrayBuffer(3));return t.setUint8(0,3),t.setInt16(1,e.value,!1),new Uint8Array(t.buffer);case"integer":var r=new DataView(new ArrayBuffer(5));return r.setUint8(0,4),r.setInt32(1,e.value,!1),new Uint8Array(r.buffer);case"long":var n=new Uint8Array(9);return n[0]=5,n.set(e.value.bytes,1),n;case"binary":var a=new DataView(new ArrayBuffer(3+e.value.byteLength));a.setUint8(0,6),a.setUint16(1,e.value.byteLength,!1);var o=new Uint8Array(a.buffer);return o.set(e.value,3),o;case"string":var i=this.fromUtf8(e.value),s=new DataView(new ArrayBuffer(3+i.byteLength));s.setUint8(0,7),s.setUint16(1,i.byteLength,!1);var u=new Uint8Array(s.buffer);return u.set(i,3),u;case"timestamp":var c=new Uint8Array(9);return c[0]=8,c.set(pe.fromNumber(e.value.valueOf()).bytes,1),c;case"uuid":if(!Pe.test(e.value))throw new Error("Invalid UUID received: "+e.value);var f=new Uint8Array(17);return f[0]=9,f.set(function(e){if(e.length%2!=0)throw new Error("Hex encoded strings must have an even number length");for(var t=new Uint8Array(e.length/2),r=0;r<e.length;r+=2){var n=e.substr(r,2).toLowerCase();if(!(n in le))throw new Error("Cannot decode unrecognized sequence "+n+" as hexadecimal");t[r/2]=le[n]}return t}(e.value.replace(/\-/g,"")),1),f}},t.prototype.parse=function(e){for(var t={},r=0;r<e.byteLength;){var n=e.getUint8(r++),a=this.toUtf8(new Uint8Array(e.buffer,e.byteOffset+r,n));switch(r+=n,e.getUint8(r++)){case 0:t[a]={type:we,value:!0};break;case 1:t[a]={type:we,value:!1};break;case 2:t[a]={type:me,value:e.getInt8(r++)};break;case 3:t[a]={type:be,value:e.getInt16(r,!1)},r+=2;break;case 4:t[a]={type:Ae,value:e.getInt32(r,!1)},r+=4;break;case 5:t[a]={type:Se,value:new pe(new Uint8Array(e.buffer,e.byteOffset+r,8))},r+=8;break;case 6:var o=e.getUint16(r,!1);r+=2,t[a]={type:Ee,value:new Uint8Array(e.buffer,e.byteOffset+r,o)},r+=o;break;case 7:var i=e.getUint16(r,!1);r+=2,t[a]={type:ke,value:this.toUtf8(new Uint8Array(e.buffer,e.byteOffset+r,i))},r+=i;break;case 8:t[a]={type:Oe,value:new Date(new pe(new Uint8Array(e.buffer,e.byteOffset+r,8)).valueOf())},r+=8;break;case 9:var s=new Uint8Array(e.buffer,e.byteOffset+r,16);r+=16,t[a]={type:xe,value:ve(s.subarray(0,4))+"-"+ve(s.subarray(4,6))+"-"+ve(s.subarray(6,8))+"-"+ve(s.subarray(8,10))+"-"+ve(s.subarray(10))};break;default:throw new Error("Unrecognized header type tag")}}return t},t}();!function(e){e[e.boolTrue=0]="boolTrue",e[e.boolFalse=1]="boolFalse",e[e.byte=2]="byte",e[e.short=3]="short",e[e.integer=4]="integer",e[e.long=5]="long",e[e.byteArray=6]="byteArray",e[e.string=7]="string",e[e.timestamp=8]="timestamp",e[e.uuid=9]="uuid"}(_e||(_e={}));var we="boolean",me="byte",be="short",Ae="integer",Se="long",Ee="binary",ke="string",Oe="timestamp",xe="uuid",Pe=/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/;var Te=function(){function e(e,t){this.headerMarshaller=new ye(e,t)}return e.prototype.marshall=function(e){var t=e.headers,r=e.body,n=this.headerMarshaller.format(t),a=n.byteLength+r.byteLength+16,o=new Uint8Array(a),i=new DataView(o.buffer,o.byteOffset,o.byteLength),s=new ce.Crc32;return i.setUint32(0,a,!1),i.setUint32(4,n.byteLength,!1),i.setUint32(8,s.update(o.subarray(0,8)).digest(),!1),o.set(n,12),o.set(r,n.byteLength+12),i.setUint32(a-4,s.update(o.subarray(8,a-4)).digest(),!1),o},e.prototype.unmarshall=function(e){var t=function(e){var t=e.byteLength,r=e.byteOffset,n=e.buffer;if(t<16)throw new Error("Provided message too short to accommodate event stream message overhead");var a=new DataView(n,r,t),o=a.getUint32(0,!1);if(t!==o)throw new Error("Reported message length does not match received message length");var i=a.getUint32(4,!1),s=a.getUint32(8,!1),u=a.getUint32(t-4,!1),c=(new ce.Crc32).update(new Uint8Array(n,r,8));if(s!==c.digest())throw new Error("The prelude checksum specified in the message ("+s+") does not match the calculated CRC32 checksum ("+c.digest()+")");if(c.update(new Uint8Array(n,r+8,t-12)),u!==c.digest())throw new Error("The message checksum ("+c.digest()+") did not match the expected value of "+u);return{headers:new DataView(n,r+8+4,i),body:new Uint8Array(n,r+8+4+i,o-i-16)}}(e),r=t.headers,n=t.body;return{headers:this.headerMarshaller.parse(r),body:n}},e.prototype.formatHeaders=function(e){return this.headerMarshaller.format(e)},e}();var Re=function(){function t(e){var t=e.utf8Encoder,r=e.utf8Decoder;this.eventMarshaller=new Te(t,r),this.utfEncoder=t}return t.prototype.deserialize=function(t,r){var n,a,o,i,s,u,c;return function(t,r){var n;return(n={})[Symbol.asyncIterator]=function(){return e.__asyncGenerator(this,arguments,(function(){var n,a,o,i,s,u,c,f,l,d,h,v,p,g,_,y,w;return e.__generator(this,(function(m){switch(m.label){case 0:m.trys.push([0,12,13,18]),n=e.__asyncValues(t),m.label=1;case 1:return[4,e.__await(n.next())];case 2:if((a=m.sent()).done)return[3,11];if(o=a.value,i=r.eventMarshaller.unmarshall(o),"error"!==(s=i.headers[":message-type"].value))return[3,3];throw(u=new Error(i.headers[":error-message"].value||"UnknownError")).name=i.headers[":error-code"].value,u;case 3:return"exception"!==s?[3,5]:(c=i.headers[":exception-type"].value,(g={})[c]=i,f=g,[4,e.__await(r.deserializer(f))]);case 4:if((l=m.sent()).$unknown)throw(d=new Error(r.toUtf8(i.body))).name=c,d;throw l[c];case 5:return"event"!==s?[3,9]:((_={})[i.headers[":event-type"].value]=i,h=_,[4,e.__await(r.deserializer(h))]);case 6:return(v=m.sent()).$unknown?[3,10]:[4,e.__await(v)];case 7:return[4,m.sent()];case 8:return m.sent(),[3,10];case 9:throw Error("Unrecognizable event type: "+i.headers[":event-type"].value);case 10:return[3,1];case 11:return[3,18];case 12:return p=m.sent(),y={error:p},[3,18];case 13:return m.trys.push([13,,16,17]),a&&!a.done&&(w=n.return)?[4,e.__await(w.call(n))]:[3,15];case 14:m.sent(),m.label=15;case 15:return[3,17];case 16:if(y)throw y.error;return[7];case 17:return[7];case 18:return[2]}}))}))},n}((n=t,o=0,i=0,s=null,u=null,c=function(e){if("number"!=typeof e)throw new Error("Attempted to allocate an event message where size was not a number: "+e);o=e,i=4,s=new Uint8Array(e),new DataView(s.buffer).setUint32(0,e,!1)},(a={})[Symbol.asyncIterator]=function(){return e.__asyncGenerator(this,arguments,(function(){var t,r,a,f,l,d,h,v;return e.__generator(this,(function(p){switch(p.label){case 0:t=n[Symbol.asyncIterator](),p.label=1;case 1:return[4,e.__await(t.next())];case 2:return r=p.sent(),a=r.value,r.done?o?[3,4]:[4,e.__await(void 0)]:[3,10];case 3:return[2,p.sent()];case 4:return o!==i?[3,7]:[4,e.__await(s)];case 5:return[4,p.sent()];case 6:return p.sent(),[3,8];case 7:throw new Error("Truncated event message received.");case 8:return[4,e.__await(void 0)];case 9:return[2,p.sent()];case 10:f=a.length,l=0,p.label=11;case 11:if(!(l<f))return[3,15];if(!s){if(d=f-l,u||(u=new Uint8Array(4)),h=Math.min(4-i,d),u.set(a.slice(l,l+h),i),l+=h,(i+=h)<4)return[3,15];c(new DataView(u.buffer).getUint32(0,!1)),u=null}return v=Math.min(o-i,f-l),s.set(a.slice(l,l+v),i),i+=v,l+=v,o&&o===i?[4,e.__await(s)]:[3,14];case 12:return[4,p.sent()];case 13:p.sent(),s=null,o=0,i=0,p.label=14;case 14:return[3,11];case 15:return[3,1];case 16:return[2]}}))}))},a),{eventMarshaller:this.eventMarshaller,deserializer:r,toUtf8:this.utfEncoder})},t.prototype.serialize=function(t,r){var n,a=this;return(n={})[Symbol.asyncIterator]=function(){return e.__asyncGenerator(this,arguments,(function(){var n,o,i,s,u,c,f;return e.__generator(this,(function(l){switch(l.label){case 0:l.trys.push([0,7,8,13]),n=e.__asyncValues(t),l.label=1;case 1:return[4,e.__await(n.next())];case 2:return(o=l.sent()).done?[3,6]:(i=o.value,s=a.eventMarshaller.marshall(r(i)),[4,e.__await(s)]);case 3:return[4,l.sent()];case 4:l.sent(),l.label=5;case 5:return[3,1];case 6:return[3,13];case 7:return u=l.sent(),c={error:u},[3,13];case 8:return l.trys.push([8,,11,12]),o&&!o.done&&(f=n.return)?[4,e.__await(f.call(n))]:[3,10];case 9:l.sent(),l.label=10;case 10:return[3,12];case 11:if(c)throw c.error;return[7];case 12:return[7];case 13:return[4,e.__await(new Uint8Array(0))];case 14:return[4,l.sent()];case 15:return l.sent(),[2]}}))}))},n},t}();var Ce=function(){function t(e){var t=e.utf8Encoder,r=e.utf8Decoder;this.eventMarshaller=new Te(t,r),this.universalMarshaller=new Re({utf8Decoder:r,utf8Encoder:t})}return t.prototype.deserialize=function(t,r){var n="function"==typeof t[Symbol.asyncIterator]?t:function(t){return e.__asyncGenerator(this,arguments,(function(){var r,n,a,o;return e.__generator(this,(function(i){switch(i.label){case 0:r=!1,n=!1,a=new Array,t.on("error",(function(e){if(r||(r=!0),e)throw e})),t.on("data",(function(e){a.push(e)})),t.on("end",(function(){r=!0})),i.label=1;case 1:return n?[3,6]:[4,e.__await(new Promise((function(e){return setTimeout((function(){return e(a.shift())}),0)})))];case 2:return(o=i.sent())?[4,e.__await(o)]:[3,5];case 3:return[4,i.sent()];case 4:i.sent(),i.label=5;case 5:return n=r&&0===a.length,[3,1];case 6:return[2]}}))}))}(t);return this.universalMarshaller.deserialize(n,r)},t.prototype.serialize=function(t,r){var n=this.universalMarshaller.serialize(t,r);if("function"==typeof c.Readable.from)return c.Readable.from(n);var a=n[Symbol.asyncIterator](),o=new c.Readable({autoDestroy:!0,objectMode:!0,read:function(){return e.__awaiter(this,void 0,void 0,(function(){var t=this;return e.__generator(this,(function(e){return a.next().then((function(e){var r=e.done,n=e.value;r?t.push(null):t.push(n)})).catch((function(e){t.destroy(e)})),[2]}))}))}});return o.on("error",(function(){o.destroy()})),o.on("end",(function(){o.destroy()})),o},t}(),Ue=function(e){return"function"==typeof ArrayBuffer&&e instanceof ArrayBuffer||"[object ArrayBuffer]"===Object.prototype.toString.call(e)},Ie=function(e,t,n){if(void 0===t&&(t=0),void 0===n&&(n=e.byteLength-t),!Ue(e))throw new TypeError('The "input" argument must be ArrayBuffer. Received type '+typeof e+" ("+e+")");return r.Buffer.from(e,t,n)},De=function(e,t){if("string"!=typeof e)throw new TypeError('The "input" argument must be of type string. Received type '+typeof e+" ("+e+")");return t?r.Buffer.from(e,t):r.Buffer.from(e)},je=function(){function e(e,t){this.hash=t?f.createHmac(e,ze(t)):f.createHash(e)}return e.prototype.update=function(e,t){this.hash.update(ze(e,t))},e.prototype.digest=function(){return Promise.resolve(this.hash.digest())},e}();function ze(e,t){return r.Buffer.isBuffer(e)?e:"string"==typeof e?De(e,t):ArrayBuffer.isView(e)?Ie(e.buffer,e.byteOffset,e.byteLength):Ie(e)}var qe=function(t){function r(e,r){var n=t.call(this,r)||this;return n.hash=e,n}return e.__extends(r,t),r.prototype._write=function(e,t,r){try{this.hash.update(e)}catch(e){return r(e)}r()},r}(c.Writable);var Ne={environmentVariableSelector:function(e){if(Object.prototype.hasOwnProperty.call(e,"AWS_S3_USE_ARN_REGION")){if("true"===e.AWS_S3_USE_ARN_REGION)return!0;if("false"===e.AWS_S3_USE_ARN_REGION)return!1;throw new Error('Cannot load env AWS_S3_USE_ARN_REGION. Expected "true" or "false", got '+e.AWS_S3_USE_ARN_REGION+".")}},configFileSelector:function(e){if(Object.prototype.hasOwnProperty.call(e,"s3_use_arn_region")){if("true"===e.s3_use_arn_region)return!0;if("false"===e.s3_use_arn_region)return!1;throw new Error('Cannot load shared config entry s3_use_arn_region. Expected "true" or "false", got '+e.s3_use_arn_region+".")}},default:!1},Le=function(t){return"function"==typeof t?function(){return e.__awaiter(void 0,void 0,void 0,(function(){return e.__generator(this,(function(e){return[2,t()]}))}))}:(r=t,function(){return Promise.resolve(r)});var r},Me=function(t,r){var n,a=t.environmentVariableSelector,o=t.configFileSelector,i=t.default;return void 0===r&&(r={}),k(E((n=a,function(){return e.__awaiter(void 0,void 0,void 0,(function(){var t;return e.__generator(this,(function(e){try{if(void 0===(t=n(process.env)))throw new Error;return[2,t]}catch(e){throw new S(e.message||"Cannot load config from environment variables with getter: "+n)}return[2]}))}))}),function(t,r){void 0===r&&(r={});var n=r.preferredFile,a=void 0===n?"config":n,o=e.__rest(r,["preferredFile"]);return function(){return e.__awaiter(void 0,void 0,void 0,(function(){var r,n,i,s,u,c,f,l,d,h,v;return e.__generator(this,(function(p){switch(p.label){case 0:return r=o.loadedConfig,n=void 0===r?W(o):r,i=o.profile,s=void 0===i?process.env.AWS_PROFILE||"default":i,[4,n];case 1:u=p.sent(),c=u.configFile,f=u.credentialsFile,l=f[s]||{},d=c[s]||{},h="config"===a?e.__assign(e.__assign({},l),d):e.__assign(e.__assign({},d),l);try{if(void 0===(v=t(h)))throw new Error;return[2,v]}catch(e){throw new S(e.message||"Cannot load config for profile "+s+" in SDK configuration files with getter: "+t)}return[2]}}))}))}}(o,r),Le(i)))},He=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,Be)},Be=function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()};var We=function(t){var r,n,a={};try{for(var o=e.__values(Object.keys(t)),i=o.next();!i.done;i=o.next()){var s=i.value,u=t[s];a[s]=Array.isArray(u)?u.join(","):u}}catch(e){r={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return a};function Fe(e,t){t instanceof c.Readable?t.pipe(e):t?e.end(Buffer.from(t)):e.end()}var Ke=function(){function t(e){var t=void 0===e?{}:e,r=t.connectionTimeout,a=t.socketTimeout,o=t.httpAgent,i=t.httpsAgent;this.metadata={handlerProtocol:"http/1.1"},this.connectionTimeout=r,this.socketTimeout=a;this.httpAgent=o||new n.Agent({keepAlive:true}),this.httpsAgent=i||new d.Agent({keepAlive:true})}return t.prototype.destroy=function(){this.httpAgent.destroy(),this.httpsAgent.destroy()},t.prototype.handle=function(t,r){var a=this,o=r.abortSignal;return new Promise((function(r,i){if(null==o?void 0:o.aborted){var s=new Error("Request aborted");return s.name="AbortError",void i(s)}var u="https:"===t.protocol,c=function(t){var r,n,a=[];try{for(var o=e.__values(Object.keys(t).sort()),i=o.next();!i.done;i=o.next()){var s=i.value,u=t[s];if(s=He(s),Array.isArray(u))for(var c=0,f=u.length;c<f;c++)a.push(s+"="+He(u[c]));else{var l=s;(u||"string"==typeof u)&&(l+="="+He(u)),a.push(l)}}}catch(e){r={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return a.join("&")}(t.query||{}),f={headers:t.headers,host:t.hostname,method:t.method,path:c?t.path+"?"+c:t.path,port:t.port,agent:u?a.httpsAgent:a.httpAgent},l=(u?d.request:n.request)(f,(function(t){var n=new e.HttpResponse({statusCode:t.statusCode||-1,headers:We(t.headers),body:t});r({response:n})}));l.on("error",i),function(e,t,r){void 0===r&&(r=0),r&&e.on("socket",(function(e){var n=this;if(e.connecting){var a=setTimeout((function(){n.abort();var e=new Error("Socket timed out without establishing a connection within "+r+" ms");e.name="TimeoutError",t(e)}),r);e.on("connect",(function(){clearTimeout(a)}))}}))}(l,i,a.connectionTimeout),function(e,t,r){void 0===r&&(r=0),e.setTimeout(r,(function(){this.abort();var e=new Error("Connection timed out after "+r+" ms");e.name="TimeoutError",t(e)}))}(l,i,a.socketTimeout),o&&(o.onabort=function(){l.abort();var e=new Error("Request aborted");e.name="AbortError",i(e)}),function(e,t){"100-continue"===(t.headers.Expect||t.headers.expect)?e.on("continue",(function(){Fe(e,t.body)})):Fe(e,t.body)}(l,t)}))},t}(),Ve=function(t){function r(){var e=null!==t&&t.apply(this,arguments)||this;return e.bufferedBytes=[],e}return e.__extends(r,t),r.prototype._write=function(e,t,r){this.bufferedBytes.push(e),r()},r}(c.Writable);const Ge=new Set(["ap-east-1","ap-northeast-1","ap-northeast-2","ap-south-1","ap-southeast-1","ap-southeast-2","ca-central-1","eu-central-1","eu-north-1","eu-west-1","eu-west-2","eu-west-3","me-south-1","sa-east-1","us-east-1","us-east-2","us-west-1","us-west-2"]),Xe=new Set(["cn-north-1","cn-northwest-1"]),$e=new Set(["us-iso-east-1"]),Ze=new Set(["us-isob-east-1"]),Ye=new Set(["us-gov-east-1","us-gov-west-1"]),Je={...{apiVersion:"2006-03-01",disableHostPrefix:!1,logger:{},regionInfoProvider:(e,t)=>{let r=void 0;switch(e){case"ap-east-1":r={hostname:"s3.ap-east-1.amazonaws.com",partition:"aws"};break;case"ap-northeast-1":r={hostname:"s3.ap-northeast-1.amazonaws.com",partition:"aws"};break;case"ap-northeast-2":r={hostname:"s3.ap-northeast-2.amazonaws.com",partition:"aws"};break;case"ap-south-1":r={hostname:"s3.ap-south-1.amazonaws.com",partition:"aws"};break;case"ap-southeast-1":r={hostname:"s3.ap-southeast-1.amazonaws.com",partition:"aws"};break;case"ap-southeast-2":r={hostname:"s3.ap-southeast-2.amazonaws.com",partition:"aws"};break;case"ca-central-1":r={hostname:"s3.ca-central-1.amazonaws.com",partition:"aws"};break;case"cn-north-1":r={hostname:"s3.cn-north-1.amazonaws.com.cn",partition:"aws-cn"};break;case"cn-northwest-1":r={hostname:"s3.cn-northwest-1.amazonaws.com.cn",partition:"aws-cn"};break;case"eu-central-1":r={hostname:"s3.eu-central-1.amazonaws.com",partition:"aws"};break;case"eu-north-1":r={hostname:"s3.eu-north-1.amazonaws.com",partition:"aws"};break;case"eu-west-1":r={hostname:"s3.eu-west-1.amazonaws.com",partition:"aws"};break;case"eu-west-2":r={hostname:"s3.eu-west-2.amazonaws.com",partition:"aws"};break;case"eu-west-3":r={hostname:"s3.eu-west-3.amazonaws.com",partition:"aws"};break;case"fips-us-gov-west-1":r={hostname:"s3-fips-us-gov-west-1.amazonaws.com",partition:"aws-us-gov",signingRegion:"us-gov-west-1"};break;case"me-south-1":r={hostname:"s3.me-south-1.amazonaws.com",partition:"aws"};break;case"s3-external-1":r={hostname:"s3-external-1.amazonaws.com",partition:"aws",signingRegion:"us-east-1"};break;case"sa-east-1":r={hostname:"s3.sa-east-1.amazonaws.com",partition:"aws"};break;case"us-east-1":r={hostname:"s3.amazonaws.com",partition:"aws"};break;case"us-east-2":r={hostname:"s3.us-east-2.amazonaws.com",partition:"aws"};break;case"us-gov-east-1":r={hostname:"s3.us-gov-east-1.amazonaws.com",partition:"aws-us-gov"};break;case"us-gov-west-1":r={hostname:"s3.us-gov-west-1.amazonaws.com",partition:"aws-us-gov"};break;case"us-iso-east-1":r={hostname:"s3.us-iso-east-1.c2s.ic.gov",partition:"aws-iso"};break;case"us-isob-east-1":r={hostname:"s3.us-isob-east-1.sc2s.sgov.gov",partition:"aws-iso-b"};break;case"us-west-1":r={hostname:"s3.us-west-1.amazonaws.com",partition:"aws"};break;case"us-west-2":r={hostname:"s3.us-west-2.amazonaws.com",partition:"aws"};break;default:Ge.has(e)&&(r={hostname:"s3.{region}.amazonaws.com".replace("{region}",e),partition:"aws"}),Xe.has(e)&&(r={hostname:"s3.{region}.amazonaws.com.cn".replace("{region}",e),partition:"aws-cn"}),$e.has(e)&&(r={hostname:"s3.{region}.c2s.ic.gov".replace("{region}",e),partition:"aws-iso"}),Ze.has(e)&&(r={hostname:"s3.{region}.sc2s.sgov.gov".replace("{region}",e),partition:"aws-iso-b"}),Ye.has(e)&&(r={hostname:"s3.{region}.amazonaws.com".replace("{region}",e),partition:"aws-us-gov"}),void 0===r&&(r={hostname:"s3.{region}.amazonaws.com".replace("{region}",e),partition:"aws"})}return Promise.resolve(r)},signingEscapePath:!1,signingName:"s3",useArnRegion:!1},runtime:"node",base64Decoder:function(e){var t=De(e,"base64");return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)},base64Encoder:function(e){return Ie(e.buffer,e.byteOffset,e.byteLength).toString("base64")},bodyLengthChecker:function(e){return e?"string"==typeof e?Buffer.from(e).length:"number"==typeof e.byteLength?e.byteLength:"number"==typeof e.size?e.size:"string"==typeof e.path?a.lstatSync(e.path).size:void 0:0},credentialDefaultProvider:function(t){void 0===t&&(t={});var r=t.profile,n=(void 0===r?process.env.AWS_PROFILE:r)?Z(t):E((function(){var e=process.env.AWS_ACCESS_KEY_ID,t=process.env.AWS_SECRET_ACCESS_KEY,r=process.env.AWS_CREDENTIAL_EXPIRATION;return e&&t?Promise.resolve({accessKeyId:e,secretAccessKey:t,sessionToken:process.env.AWS_SESSION_TOKEN,expiration:r?new Date(r):void 0}):Promise.reject(new S("Unable to find environment variable credentials."))}),Z(t),te(t),function(t){if(process.env[U]||process.env[C])return I(t);if(process.env.AWS_EC2_METADATA_DISABLED)return function(){return Promise.reject(new S("EC2 Instance Metadata Service access disabled"))};return function(t){void 0===t&&(t={});var r=!1,n=T(t),a=n.timeout,o=n.maxRetries,i=function(t,n){return e.__awaiter(void 0,void 0,void 0,(function(){var a;return e.__generator(this,(function(o){switch(o.label){case 0:return[4,R((function(){return e.__awaiter(void 0,void 0,void 0,(function(){var t,a;return e.__generator(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,M(n)];case 1:return t=e.sent(),[3,3];case 2:throw 401===(a=e.sent()).statusCode&&(r=!1),a;case 3:return[2,t]}}))}))}),t)];case 1:return a=o.sent().trim(),[2,R((function(){return e.__awaiter(void 0,void 0,void 0,(function(){var t,o;return e.__generator(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,H(a,n)];case 1:return t=e.sent(),[3,3];case 2:throw 401===(o=e.sent()).statusCode&&(r=!1),o;case 3:return[2,t]}}))}))}),t)]}}))}))};return function(){return e.__awaiter(void 0,void 0,void 0,(function(){var t,n;return e.__generator(this,(function(e){switch(e.label){case 0:return r?[2,i(o,{timeout:a})]:[3,1];case 1:t=void 0,e.label=2;case 2:return e.trys.push([2,4,,5]),[4,L({timeout:a})];case 3:return t=e.sent().toString(),[3,5];case 4:if(400===(null==(n=e.sent())?void 0:n.statusCode))throw Object.assign(n,{message:"EC2 Metadata token request returned error"});return("TimeoutError"===n.message||[403,404,405].includes(n.statusCode))&&(r=!0),[2,i(o,{timeout:a})];case 5:return[2,i(o,{timeout:a,headers:{"x-aws-ec2-metadata-token":t}})]}}))}))}}(t)}(t));return k(n,(function(e){return void 0!==e.expiration&&e.expiration.getTime()-Date.now()<3e5}),(function(e){return void 0!==e.expiration}))},defaultUserAgent:(Qe=_,et=y,tt=g.default.platform+"/"+g.default.version,g.default.env.AWS_EXECUTION_ENV&&(tt+=" exec-env/"+g.default.env.AWS_EXECUTION_ENV),"aws-sdk-nodejs-v3-"+Qe+"/"+et+" "+tt),eventStreamSerdeProvider:function(e){return new Ce(e)},maxAttempts:Me(l.NODE_MAX_ATTEMPT_CONFIG_OPTIONS),md5:je.bind(null,"md5"),region:Me(b,{preferredFile:"credentials"}),requestHandler:new Ke,sha256:je.bind(null,"sha256"),streamCollector:function(e){return new Promise((function(t,r){var n=new Ve;e.pipe(n),e.on("error",(function(e){n.end(),r(e)})),n.on("error",r),n.on("finish",(function(){var e=new Uint8Array(Buffer.concat(this.bufferedBytes));t(e)}))}))},streamHasher:function(e,t){return new Promise((function(r,n){if("string"==typeof t.path){var o=a.createReadStream(t.path,{start:t.start,end:t.end}),i=new e,s=new qe(i);o.pipe(s),o.on("error",(function(e){s.end(),n(e)})),s.on("error",n),s.on("finish",(function(){i.digest().then(r).catch(n)}))}else n(new Error("Unable to calculate hash for non-file streams."))}))},urlParser:function(r){var n,a=t.parse(r),o=a.hostname,i=void 0===o?"localhost":o,s=a.pathname,u=void 0===s?"/":s,c=a.port,f=a.protocol,l=void 0===f?"https:":f,d=a.search;return d&&(n=function(t){var r,n,a={};if(t=t.replace(/^\?/,""))try{for(var o=e.__values(t.split("&")),i=o.next();!i.done;i=o.next()){var s=i.value,u=e.__read(s.split("="),2),c=u[0],f=u[1],l=void 0===f?null:f;c=decodeURIComponent(c),l&&(l=decodeURIComponent(l)),c in a?Array.isArray(a[c])?a[c].push(l):a[c]=[a[c],l]:a[c]=l}}catch(e){r={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return a}(d)),{hostname:i,port:c?parseInt(c):void 0,protocol:l,path:u,query:n}},useArnRegion:Me(Ne),utf8Decoder:function(e){var t=De(e,"utf8");return new Uint8Array(t.buffer,t.byteOffset,t.byteLength/Uint8Array.BYTES_PER_ELEMENT)},utf8Encoder:function(e){return Ie(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}};var Qe,et,tt;var rt={step:"build",tags:["SET_CONTENT_LENGTH","CONTENT_LENGTH"],name:"contentLengthMiddleware"},nt=function(t){return{applyToStack:function(r){r.add(function(t){var r=this;return function(n){return function(a){return e.__awaiter(r,void 0,void 0,(function(){var r,o,i,s,u;return e.__generator(this,(function(c){return r=a.request,e.HttpRequest.isInstance(r)&&(o=r.body,i=r.headers,o&&-1===Object.keys(i).map((function(e){return e.toLowerCase()})).indexOf("content-length")&&void 0!==(s=t(o))&&(r.headers=e.__assign(e.__assign({},r.headers),((u={})["content-length"]=String(s),u)))),[2,n(e.__assign(e.__assign({},a),{request:r}))]}))}))}}}(t.bodyLengthChecker),rt)}}};var at={step:"build",tags:["SET_EXPECT_HEADER","EXPECT_HEADER"],name:"addExpectContinueMiddleware"},ot=function(t){return{applyToStack:function(r){r.add(function(t){var r=this;return function(n){return function(a){return e.__awaiter(r,void 0,void 0,(function(){var r;return e.__generator(this,(function(o){return r=a.request,e.HttpRequest.isInstance(r)&&r.body&&"node"===t.runtime&&(r.headers=e.__assign(e.__assign({},r.headers),{Expect:"100-continue"})),[2,n(e.__assign(e.__assign({},a),{request:r}))]}))}))}}}(t),at)}}};var it={name:"hostHeaderMiddleware",step:"build",priority:"low",tags:["HOST"]},st=function(t){return{applyToStack:function(r){r.add(function(t){return function(r){return function(n){return e.__awaiter(void 0,void 0,void 0,(function(){var a,o;return e.__generator(this,(function(i){return e.HttpRequest.isInstance(n.request)?(a=n.request,(void 0===(o=(t.requestHandler.metadata||{}).handlerProtocol)?"":o).indexOf("h2")>=0&&!a.headers[":authority"]?(delete a.headers.host,a.headers[":authority"]=""):a.headers.host||(a.headers.host=a.hostname),[2,r(n)]):[2,r(n)]}))}))}}}(t),it)}}},ut={name:"loggerMiddleware",tags:["LOGGER"],step:"build"},ct=function(t){return{applyToStack:function(t){t.add((function(t,r){return function(n){return e.__awaiter(void 0,void 0,void 0,(function(){var a,o,i;return e.__generator(this,(function(e){switch(e.label){case 0:return a=r.logger,[4,t(n)];case 1:return o=e.sent(),a?(i=o.output.$metadata,"function"==typeof a.info&&a.info({$metadata:i}),[2,o]):[2,o]}}))}))}}),ut)}}};var ft={step:"initialize",tags:["VALIDATE_BUCKET_NAME"],name:"validateBucketNameMiddleware"},lt=function(t){return{applyToStack:function(t){t.add(function(){var t=this;return function(r){return function(n){return e.__awaiter(t,void 0,void 0,(function(){var t,a;return e.__generator(this,(function(o){if("string"==typeof(t=n.input.Bucket)&&!v.validate(t)&&t.indexOf("/")>=0)throw(a=new Error("Bucket name shouldn't contain '/', received '"+t+"'")).name="InvalidBucketName",a;return[2,r(e.__assign({},n))]}))}))}}}(),ft)}}},dt={step:"build",tags:["USE_REGIONAL_ENDPOINT","S3"],name:"useRegionalEndpointMiddleware"},ht=function(t){return{applyToStack:function(r){r.add(function(t){return function(r){return function(n){return e.__awaiter(void 0,void 0,void 0,(function(){var a,o;return e.__generator(this,(function(i){switch(i.label){case 0:return a=n.request,!e.HttpRequest.isInstance(a)||t.isCustomEndpoint?[2,r(e.__assign({},n))]:"s3.amazonaws.com"!==a.hostname?[3,1]:(a.hostname="s3.us-east-1.amazonaws.com",[3,3]);case 1:return o="aws-global",[4,t.region()];case 2:o===i.sent()&&(a.hostname="s3.amazonaws.com"),i.label=3;case 3:return[2,r(e.__assign({},n))]}}))}))}}}(t),dt)}}},vt="X-Amz-Date".toLowerCase(),pt=["authorization",vt,"date"],gt="X-Amz-Signature".toLowerCase(),_t="X-Amz-Security-Token".toLowerCase(),yt={authorization:!0,"cache-control":!0,connection:!0,expect:!0,from:!0,"keep-alive":!0,"max-forwards":!0,pragma:!0,referer:!0,te:!0,trailer:!0,"transfer-encoding":!0,upgrade:!0,"user-agent":!0,"x-amzn-trace-id":!0},wt=/^proxy-/,mt=/^sec-/,bt="AWS4-HMAC-SHA256-PAYLOAD",At={},St=[];function Et(e,t,r){return e+"/"+t+"/"+r+"/aws4_request"}function kt(t,r,n){var a,o,i=t.headers,s={};try{for(var u=e.__values(Object.keys(i).sort()),c=u.next();!c.done;c=u.next()){var f=c.value,l=f.toLowerCase();(l in yt||(null==r?void 0:r.has(l))||wt.test(l)||mt.test(l))&&(!n||n&&!n.has(l))||(s[l]=i[f].trim().replace(/\s+/g," "))}}catch(e){a={error:e}}finally{try{c&&!c.done&&(o=u.return)&&o.call(u)}finally{if(a)throw a.error}}return s}function Ot(t,r){var n=t.headers,a=t.body;return e.__awaiter(this,void 0,void 0,(function(){var t,o,i,s,u,c,f;return e.__generator(this,(function(l){switch(l.label){case 0:try{for(t=e.__values(Object.keys(n)),o=t.next();!o.done;o=t.next())if("x-amz-content-sha256"===(i=o.value).toLowerCase())return[2,n[i]]}catch(e){c={error:e}}finally{try{o&&!o.done&&(f=t.return)&&f.call(t)}finally{if(c)throw c.error}}return null!=a?[3,1]:[2,"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"];case 1:return"string"==typeof a||ArrayBuffer.isView(a)||Ue(a)?((s=new r).update(a),u=ve,[4,s.digest()]):[3,3];case 2:return[2,u.apply(void 0,[l.sent()])];case 3:return[2,"UNSIGNED-PAYLOAD"]}}))}))}function xt(t){var r=t.headers,n=t.query,a=e.__rest(t,["headers","query"]);return e.__assign(e.__assign({},a),{headers:e.__assign({},r),query:n?Pt(n):void 0})}function Pt(t){return Object.keys(t).reduce((function(r,n){var a,o=t[n];return e.__assign(e.__assign({},r),((a={})[n]=Array.isArray(o)?e.__spread(o):o,a))}),{})}function Tt(t){var r,n;t="function"==typeof t.clone?t.clone():xt(t);try{for(var a=e.__values(Object.keys(t.headers)),o=a.next();!o.done;o=a.next()){var i=o.value;pt.indexOf(i.toLowerCase())>-1&&delete t.headers[i]}}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return t}function Rt(e){return function(e){if("number"==typeof e)return new Date(1e3*e);if("string"==typeof e)return Number(e)?new Date(1e3*Number(e)):new Date(e);return e}(e).toISOString().replace(/\.\d{3}Z$/,"Z")}var Ct=function(){function t(e){var t=e.applyChecksum,r=e.credentials,n=e.region,a=e.service,o=e.sha256,i=e.uriEscapePath,s=void 0===i||i;this.service=a,this.sha256=o,this.uriEscapePath=s,this.applyChecksum="boolean"!=typeof t||t,this.regionProvider=Dt(n),this.credentialProvider=jt(r)}return t.prototype.presign=function(t,r){return void 0===r&&(r={}),e.__awaiter(this,void 0,void 0,(function(){var n,a,o,i,s,u,c,f,l,d,h,v,p,g,_,y,w,m,b,A,S,E,k;return e.__generator(this,(function(O){switch(O.label){case 0:return n=r.signingDate,a=void 0===n?new Date:n,o=r.expiresIn,i=void 0===o?3600:o,s=r.unsignableHeaders,u=r.signableHeaders,c=r.signingRegion,f=r.signingService,[4,this.credentialProvider()];case 1:return l=O.sent(),null==c?[3,2]:(h=c,[3,4]);case 2:return[4,this.regionProvider()];case 3:h=O.sent(),O.label=4;case 4:return d=h,v=Ut(a),p=v.longDate,g=v.shortDate,i>604800?[2,Promise.reject("Signature version 4 presigned URLs must have an expiration date less than one week in the future")]:(_=Et(g,d,null!=f?f:this.service),y=function(t){var r,n,a="function"==typeof t.clone?t.clone():xt(t),o=a.headers,i=a.query,s=void 0===i?{}:i;try{for(var u=e.__values(Object.keys(o)),c=u.next();!c.done;c=u.next()){var f=c.value;"x-amz-"===f.toLowerCase().substr(0,6)&&(s[f]=o[f],delete o[f])}}catch(e){r={error:e}}finally{try{c&&!c.done&&(n=u.return)&&n.call(u)}finally{if(r)throw r.error}}return e.__assign(e.__assign({},t),{headers:o,query:s})}(Tt(t)),l.sessionToken&&(y.query["X-Amz-Security-Token"]=l.sessionToken),y.query["X-Amz-Algorithm"]="AWS4-HMAC-SHA256",y.query["X-Amz-Credential"]=l.accessKeyId+"/"+_,y.query["X-Amz-Date"]=p,y.query["X-Amz-Expires"]=i.toString(10),w=kt(y,s,u),y.query["X-Amz-SignedHeaders"]=It(w),m=y.query,b="X-Amz-Signature",A=this.getSignature,S=[p,_,this.getSigningKey(l,d,g,f)],E=this.createCanonicalRequest,k=[y,w],[4,Ot(t,this.sha256)]);case 5:return[4,A.apply(this,S.concat([E.apply(this,k.concat([O.sent()]))]))];case 6:return m[b]=O.sent(),[2,y]}}))}))},t.prototype.sign=function(t,r){return e.__awaiter(this,void 0,void 0,(function(){return e.__generator(this,(function(e){return"string"==typeof t?[2,this.signString(t,r)]:t.headers&&t.payload?[2,this.signEvent(t,r)]:[2,this.signRequest(t,r)]}))}))},t.prototype.signEvent=function(t,r){var n=t.headers,a=t.payload,o=r.signingDate,i=void 0===o?new Date:o,s=r.priorSignature,u=r.signingRegion,c=r.signingService;return e.__awaiter(this,void 0,void 0,(function(){var t,r,o,f,l,d,h,v,p,g,_;return e.__generator(this,(function(e){switch(e.label){case 0:return null==u?[3,1]:(r=u,[3,3]);case 1:return[4,this.regionProvider()];case 2:r=e.sent(),e.label=3;case 3:return t=r,o=Ut(i),f=o.shortDate,l=o.longDate,d=Et(f,t,null!=c?c:this.service),[4,Ot({headers:{},body:a},this.sha256)];case 4:return h=e.sent(),(v=new this.sha256).update(n),g=ve,[4,v.digest()];case 5:return p=g.apply(void 0,[e.sent()]),_=[bt,l,d,s,p,h].join("\n"),[2,this.signString(_,{signingDate:i,signingRegion:t,signingService:c})]}}))}))},t.prototype.signString=function(t,r){var n=void 0===r?{}:r,a=n.signingDate,o=void 0===a?new Date:a,i=n.signingRegion,s=n.signingService;return e.__awaiter(this,void 0,void 0,(function(){var r,n,a,u,c,f,l,d;return e.__generator(this,(function(e){switch(e.label){case 0:return[4,this.credentialProvider()];case 1:return r=e.sent(),null==i?[3,2]:(a=i,[3,4]);case 2:return[4,this.regionProvider()];case 3:a=e.sent(),e.label=4;case 4:return n=a,u=Ut(o).shortDate,l=(f=this.sha256).bind,[4,this.getSigningKey(r,n,u,s)];case 5:return(c=new(l.apply(f,[void 0,e.sent()]))).update(t),d=ve,[4,c.digest()];case 6:return[2,d.apply(void 0,[e.sent()])]}}))}))},t.prototype.signRequest=function(t,r){var n=void 0===r?{}:r,a=n.signingDate,o=void 0===a?new Date:a,i=n.signableHeaders,s=n.unsignableHeaders,u=n.signingRegion,c=n.signingService;return e.__awaiter(this,void 0,void 0,(function(){var r,n,a,f,l,d,h,v,p,g,_;return e.__generator(this,(function(y){switch(y.label){case 0:return[4,this.credentialProvider()];case 1:return r=y.sent(),null==u?[3,2]:(a=u,[3,4]);case 2:return[4,this.regionProvider()];case 3:a=y.sent(),y.label=4;case 4:return n=a,f=Tt(t),l=Ut(o),d=l.longDate,h=l.shortDate,v=Et(h,n,null!=c?c:this.service),f.headers[vt]=d,r.sessionToken&&(f.headers[_t]=r.sessionToken),[4,Ot(f,this.sha256)];case 5:return p=y.sent(),!function(t,r){var n,a;t=t.toLowerCase();try{for(var o=e.__values(Object.keys(r)),i=o.next();!i.done;i=o.next())if(t===i.value.toLowerCase())return!0}catch(e){n={error:e}}finally{try{i&&!i.done&&(a=o.return)&&a.call(o)}finally{if(n)throw n.error}}return!1}("x-amz-content-sha256",f.headers)&&this.applyChecksum&&(f.headers["x-amz-content-sha256"]=p),g=kt(f,s,i),[4,this.getSignature(d,v,this.getSigningKey(r,n,h,c),this.createCanonicalRequest(f,g,p))];case 6:return _=y.sent(),f.headers.authorization="AWS4-HMAC-SHA256 Credential="+r.accessKeyId+"/"+v+", SignedHeaders="+It(g)+", Signature="+_,[2,f]}}))}))},t.prototype.createCanonicalRequest=function(t,r,n){var a=Object.keys(r).sort();return t.method+"\n"+this.getCanonicalPath(t)+"\n"+function(t){var r,n,a=t.query,o=void 0===a?{}:a,i=[],s={},u=function(e){if(e.toLowerCase()===gt)return"continue";i.push(e);var t=o[e];"string"==typeof t?s[e]=He(e)+"="+He(t):Array.isArray(t)&&(s[e]=t.slice(0).sort().reduce((function(t,r){return t.concat([He(e)+"="+He(r)])}),[]).join("&"))};try{for(var c=e.__values(Object.keys(o).sort()),f=c.next();!f.done;f=c.next())u(f.value)}catch(e){r={error:e}}finally{try{f&&!f.done&&(n=c.return)&&n.call(c)}finally{if(r)throw r.error}}return i.map((function(e){return s[e]})).filter((function(e){return e})).join("&")}(t)+"\n"+a.map((function(e){return e+":"+r[e]})).join("\n")+"\n\n"+a.join(";")+"\n"+n},t.prototype.createStringToSign=function(t,r,n){return e.__awaiter(this,void 0,void 0,(function(){var a,o;return e.__generator(this,(function(e){switch(e.label){case 0:return(a=new this.sha256).update(n),[4,a.digest()];case 1:return o=e.sent(),[2,"AWS4-HMAC-SHA256\n"+t+"\n"+r+"\n"+ve(o)]}}))}))},t.prototype.getCanonicalPath=function(e){var t=e.path;return this.uriEscapePath?"/"+encodeURIComponent(t.replace(/^\//,"")).replace(/%2F/g,"/"):t},t.prototype.getSignature=function(t,r,n,a){return e.__awaiter(this,void 0,void 0,(function(){var o,i,s,u,c;return e.__generator(this,(function(e){switch(e.label){case 0:return[4,this.createStringToSign(t,r,a)];case 1:return o=e.sent(),u=(s=this.sha256).bind,[4,n];case 2:return(i=new(u.apply(s,[void 0,e.sent()]))).update(o),c=ve,[4,i.digest()];case 3:return[2,c.apply(void 0,[e.sent()])]}}))}))},t.prototype.getSigningKey=function(t,r,n,a){return function(t,r,n,a,o){var i=n+":"+a+":"+o+":"+r.accessKeyId+":"+r.sessionToken;if(i in At)return At[i];for(St.push(i);St.length>50;)delete At[St.shift()];return At[i]=new Promise((function(s,u){var c,f,l=Promise.resolve("AWS4"+r.secretAccessKey),d=function(e){(l=l.then((function(r){return n=e,(a=new t(r)).update(n),a.digest();var n,a}))).catch((function(){}))};try{for(var h=e.__values([n,a,o,"aws4_request"]),v=h.next();!v.done;v=h.next())d(v.value)}catch(e){c={error:e}}finally{try{v&&!v.done&&(f=h.return)&&f.call(h)}finally{if(c)throw c.error}}l.then(s,(function(e){delete At[i],u(e)}))}))}(this.sha256,t,n,r,a||this.service)},t}(),Ut=function(e){var t=Rt(e).replace(/[\-:]/g,"");return{longDate:t,shortDate:t.substr(0,8)}},It=function(e){return Object.keys(e).sort().join(";")},Dt=function(e){if("string"==typeof e){var t=Promise.resolve(e);return function(){return t}}return e},jt=function(e){if("object"==typeof e){var t=Promise.resolve(e);return function(){return t}}return e};function zt(e){if("object"==typeof e){var t=Promise.resolve(e);return function(){return t}}return e}var qt=function(e){return new Date(Date.now()+e)};function Nt(t){return function(r,n){return function(a){return e.__awaiter(this,void 0,void 0,(function(){var o,i,s,u,c,f,l,d,h;return e.__generator(this,(function(v){switch(v.label){case 0:return e.HttpRequest.isInstance(a.request)?"function"!=typeof t.signer?[3,2]:[4,t.signer()]:[2,r(a)];case 1:return i=v.sent(),[3,3];case 2:i=t.signer,v.label=3;case 3:return o=i,u=r,c=[e.__assign({},a)],h={},[4,o.sign(a.request,{signingDate:new Date(Date.now()+t.systemClockOffset),signingRegion:n.signing_region,signingService:n.signing_service})];case 4:return[4,u.apply(void 0,[e.__assign.apply(void 0,c.concat([(h.request=v.sent(),h)]))])];case 5:return s=v.sent(),f=s.response.headers,(l=f&&(f.date||f.Date))&&(d=Date.parse(l),p=d,g=t.systemClockOffset,Math.abs(qt(g).getTime()-p)>=3e5&&(t.systemClockOffset=d-Date.now())),[2,s]}var p,g}))}))}}}var Lt={name:"awsAuthMiddleware",tags:["SIGNATURE","AWSAUTH"],relation:"after",toMiddleware:"retryMiddleware"};var Mt={name:"getUserAgentMiddleware",step:"build",tags:["SET_USER_AGENT","USER_AGENT"]},Ht=function(t){return{applyToStack:function(r){var n;r.add((n=t,function(t){return function(r){var a=r.request;if(!e.HttpRequest.isInstance(a))return t(r);var o=a.headers,i="node"===n.runtime?"user-agent":"x-amz-user-agent";return o[i]?o[i]+=" "+n.defaultUserAgent:o[i]=""+n.defaultUserAgent,n.customUserAgent&&(o[i]+=" "+n.customUserAgent),t(e.__assign(e.__assign({},r),{request:a}))}}),Mt)}}};class Bt extends v.Client{constructor(t){let r=function(t){if(!t.region)throw new Error("Region is missing");return e.__assign(e.__assign({},t),{region:A(t.region)})}({...Je,...t});var n,a;let o=function(t){var r,n=this,a=zt(t.credentials||t.credentialDefaultProvider(t)),o=t.signingEscapePath,i=void 0===o||o,s=t.systemClockOffset,u=void 0===s?t.systemClockOffset||0:s,c=t.sha256;return r=t.signer?zt(t.signer):function(){return zt(t.region)().then((function(r){return e.__awaiter(n,void 0,void 0,(function(){return e.__generator(this,(function(e){switch(e.label){case 0:return[4,t.regionInfoProvider(r)];case 1:return[2,[e.sent()||{},r]]}}))}))})).then((function(r){var n=e.__read(r,2),o=n[0],s=n[1],u=o.signingRegion,f=void 0===u?t.signingRegion:u,l=o.signingService,d=void 0===l?t.signingName:l;return t.signingRegion=t.signingRegion||f||s,t.signingName=t.signingName||d,new Ct({credentials:a,region:t.signingRegion,service:t.signingName,sha256:c,uriEscapePath:i})}))},e.__assign(e.__assign({},t),{systemClockOffset:u,signingEscapePath:i,credentials:a,signer:r})}((n=r,e.__assign(e.__assign({},n),{tls:null===(a=n.tls)||void 0===a||a,endpoint:n.endpoint?w(n):function(){return m(n)},isCustomEndpoint:!!n.endpoint}))),i=function(t){return e.__assign(e.__assign({},t),{eventStreamMarshaller:t.eventStreamSerdeProvider(t)})}(function(t){var r=t.bucketEndpoint,n=void 0!==r&&r,a=t.forcePathStyle,o=void 0!==a&&a,i=t.useAccelerateEndpoint,s=void 0!==i&&i,u=t.useDualstackEndpoint,c=void 0!==u&&u,f=t.useArnRegion,l=void 0!==f&&f;return e.__assign(e.__assign({},t),{bucketEndpoint:n,forcePathStyle:o,useAccelerateEndpoint:s,useDualstackEndpoint:c,useArnRegion:"function"==typeof l?l:function(){return Promise.resolve(l)}})}(l.resolveRetryConfig(o)));var s;super(i),this.config=i,this.middlewareStack.use((s=this.config,{applyToStack:function(e){e.addRelativeTo(Nt(s),Lt)}})),this.middlewareStack.use(l.getRetryPlugin(this.config)),this.middlewareStack.use(Ht(this.config)),this.middlewareStack.use(nt(this.config)),this.middlewareStack.use(lt(this.config)),this.middlewareStack.use(ht(this.config)),this.middlewareStack.use(ot(this.config)),this.middlewareStack.use(st(this.config)),this.middlewareStack.use(ct(this.config))}destroy(){super.destroy()}}exports.S3Client=Bt;
